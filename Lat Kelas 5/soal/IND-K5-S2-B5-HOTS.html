<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Interaktif - IND-K5-S2-B5-HOTS</title>
    <style>
        /* Proteksi Anti Copy-Paste */
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #74ebd5 0%, #ACB6E5 100%);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* Header & Footer */
        .header {
            background-color: #ffffffcc;
            text-align: center;
            padding: 15px;
            font-weight: bold;
            font-size: 1.2rem;
            color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .footer {
            background-color: #1a1a1a;
            color: #fff;
            text-align: center;
            padding: 15px;
            margin-top: auto;
            font-size: 0.9rem;
        }
        .footer a {
            color: #74ebd5;
            text-decoration: none;
            font-weight: bold;
        }

        /* Containers */
        .container {
            max-width: 850px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            flex: 1;
            width: 90%;
        }

        /* Login Screen */
        #login-screen {
            text-align: center;
        }
        .input-group {
            margin-bottom: 15px;
            text-align: left;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #444;
        }
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 1rem;
        }
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 1rem;
            transition: 0.3s;
            margin: 5px;
        }
        .btn-start {
            background-color: #4CAF50;
            color: white;
            width: 100%;
            font-size: 1.2rem;
            padding: 15px;
            margin-top: 10px;
        }
        .btn-start:hover { background-color: #45a049; }
        .btn-home {
            background-color: #E91E63;
            color: white;
            text-decoration: none;
            display: inline-block;
            margin-top: 15px;
            margin-bottom: 25px;
            width: 100%;
            box-sizing: border-box;
        }
        .btn-home:hover { background-color: #C2185B; }

        /* History */
        .history-box {
            background: #f1f8ff;
            border: 2px dashed #90caf9;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            max-height: 200px;
            overflow-y: auto;
        }
        .history-item {
            border-bottom: 1px solid #cce3f6;
            padding: 8px 0;
            font-size: 0.95rem;
            color: #333;
        }

        /* Quiz Screen */
        #quiz-screen { display: none; }
        .info-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            background: #e3f2fd;
            color: #1565c0;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #1976d2;
        }
        .question-text {
            font-size: 1.25rem;
            margin-bottom: 20px;
            line-height: 1.6;
            color: #222;
        }
        .question-img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            display: none;
        }
        .img-caption {
            font-size: 0.9rem;
            color: #666;
            font-style: italic;
            margin-bottom: 20px;
            display: none;
            text-align: center;
        }
        
        .options-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 12px;
        }
        .option-btn {
            background-color: #fafafa;
            border: 2px solid #ddd;
            padding: 15px;
            border-radius: 8px;
            text-align: left;
            cursor: pointer;
            font-size: 1.05rem;
            transition: 0.2s;
            color: #333;
        }
        .option-btn:hover:not(:disabled) {
            background-color: #f0f0f0;
            border-color: #bbb;
        }
        .option-btn:disabled { cursor: not-allowed; }
        .correct { background-color: #d4edda !important; border-color: #28a745 !important; color: #155724 !important; font-weight: bold; }
        .wrong { background-color: #f8d7da !important; border-color: #dc3545 !important; color: #721c24 !important; font-weight: bold; }

        .pembahasan {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            color: #856404;
            border-radius: 4px;
            display: none;
            line-height: 1.5;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
        }
        .btn-nav { background-color: #607d8b; color: white; padding: 12px 25px; }
        .btn-nav:hover { background-color: #455a64; }
        .btn-finish { background-color: #ff9800; color: white; padding: 12px 25px; display: none; }
        .btn-finish:hover { background-color: #e68a00; }

        #result-screen { display: none; text-align: center; }
        .final-score { font-size: 4rem; font-weight: bold; color: #4CAF50; margin: 20px 0; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="header">
        Kode Soal: IND-K5-S2-B5-HOTS
    </div>

    <div class="container">
        <div id="login-screen">
            <h2 style="color: #333;">Selamat Datang di Kuis Interaktif</h2>
            <p style="color: #666;">Mata Pelajaran: Bahasa Indonesia | Kelas 5 SD</p>
            
            <a href="../index.html" class="btn btn-home">üîô Kembali ke Home (Luar Folder)</a>

            <div class="input-group">
                <label for="nama">Nama Lengkap:</label>
                <input type="text" id="nama" placeholder="Masukkan nama lengkap Anda..." required autocomplete="off">
            </div>
            <div class="input-group">
                <label for="kelas">Kelas:</label>
                <input type="text" id="kelas" placeholder="Masukkan kelas Anda..." required autocomplete="off">
            </div>
            
            <button class="btn btn-start" onclick="mulaiKuis()">‚ñ∂ MULAI KUIS</button>

            <h3 style="margin-top: 30px; color: #444; text-align: left;">Riwayat Pencapaian Skor</h3>
            <div class="history-box" id="history-box">
                </div>
        </div>

        <div id="quiz-screen">
            <div class="info-bar">
                <span id="q-counter">Soal: 1/25</span>
                <span id="score-live">Skor Sementara: 0</span>
            </div>
            
            <img id="q-img" class="question-img" src="" alt="Gambar Soal">
            <div id="q-caption" class="img-caption">Keterangan Gambar</div>
            
            <div id="q-text" class="question-text">Teks soal akan muncul di sini.</div>
            
            <div class="options-grid" id="options-container">
                </div>

            <div id="pembahasan-box" class="pembahasan">
                <strong>Pembahasan:</strong> <span id="pembahasan-text"></span>
            </div>

            <div class="navigation">
                <button class="btn btn-nav" id="btn-prev" onclick="soalSebelumnya()" style="visibility: hidden;">&laquo; Soal Sebelumnya</button>
                <button class="btn btn-nav" id="btn-next" onclick="soalSelanjutnya()" style="display: none;">Soal Selanjutnya &raquo;</button>
                <button class="btn btn-finish" id="btn-finish" onclick="selesaiKuis()">Selesai &amp; Simpan Skor</button>
            </div>
        </div>

        <div id="result-screen">
            <h2 style="color: #333;">Kuis Selesai!</h2>
            <p style="font-size: 1.1rem;">Luar biasa telah menyelesaikan kuis ini, <strong id="res-nama"></strong>.</p>
            <div class="final-score" id="res-skor">100</div>
            <p>Riwayat pengerjaanmu sudah tersimpan dengan aman.</p>
            <button class="btn btn-start" onclick="location.reload()" style="max-width: 300px;">Kembali ke Halaman Awal</button>
        </div>
    </div>

    <div class="footer">
        Oleh: Dwi Endrasto<br>
        Produk ini asli jika didapatkan/dibeli melalui <a href="https://lynk.id/smartbanksoal" target="_blank">https://lynk.id/smartbanksoal</a>
    </div>

    <script>
        // Kunci penyimpanan khusus agar tidak bentrok dengan kuis lain (Aman)
        const STORAGE_KEY = 'HISTORY_IND_K5_S2_B5_HOTS';

        // Bank Soal: 25 Soal Lengkap (5 Gambar, 20 Teks) dengan jumlah kata opsi yang sama persis
        const bankSoal = [
            {
                jenis: "gambar",
                imgSrc: "gambar/email-format.jpg",
                imgCaption: "",
                pertanyaan: "Berdasarkan struktur surat elektronik pada gambar, jika pengirim ingin mengirimkan salinan email kepada pihak ketiga tanpa diketahui oleh penerima utama, kolom manakah yang harus ia gunakan secara tepat?",
                jawabanBenar: "Menggunakan kolom Blind Carbon Copy (BCC).",
                jawabanSalah: [
                    "Menggunakan kolom Carbon Copy (CC) saja.",
                    "Menuliskan di kolom penerima utama (To).",
                    "Menyisipkan di bagian kotak lampiran (Attachment)."
                ],
                pembahasan: "Kolom BCC (Blind Carbon Copy) berfungsi mengirim salinan email kepada orang lain tanpa diketahui oleh penerima utama (To) maupun penerima CC."
            },
            {
                jenis: "gambar",
                imgSrc: "gambar/infografis-fakta.jpg",
                imgCaption: "",
                pertanyaan: "Setelah mengamati infografis di atas, kalimat manakah yang secara linguistik memenuhi kriteria sebagai sebuah fakta yang dapat diuji kebenarannya?",
                jawabanBenar: "Suhu rata-rata bumi naik 1,2 derajat celcius.",
                jawabanSalah: [
                    "Kenaikan suhu ini sangat meresahkan warga sekitar.",
                    "Pemerintah seharusnya bekerja lebih keras lagi sekarang.",
                    "Cuaca tahun depan pasti akan lebih panas."
                ],
                pembahasan: "Fakta berisi data spesifik, objektif, dan dapat diukur kebenarannya. Pilihan lain mengandung unsur opini/dugaan (meresahkan, seharusnya, pasti)."
            },
            {
                jenis: "gambar",
                imgSrc: "gambar/poster-akronim.jpg",
                imgCaption: "",
                pertanyaan: "Dalam poster kesehatan tersebut terdapat kata 'Puskesmas'. Mengapa kata tersebut diklasifikasikan sebagai akronim dan bukan sekadar singkatan biasa?",
                jawabanBenar: "Karena dibaca sebagai satu kata yang utuh.",
                jawabanSalah: [
                    "Karena terdiri dari huruf kapital di awal.",
                    "Karena diambil dari huruf depan tiap kata.",
                    "Karena merupakan singkatan istilah medis bidang kesehatan."
                ],
                pembahasan: "Akronim adalah kependekan dari deret kata yang dilafalkan/dibaca layaknya sebuah kata utuh, bukan dieja per huruf."
            },
            {
                jenis: "gambar",
                imgSrc: "gambar/siklus-hujan.jpg",
                imgCaption: "",
                pertanyaan: "Gambar tersebut merupakan ilustrasi teks eksplanasi. Bagian teks eksplanasi yang berfungsi menjelaskan tahapan evaporasi pada gambar tersebut berada pada struktur...",
                jawabanBenar: "Deretan penjelas atau urutan tahapan sebab akibat.",
                jawabanSalah: [
                    "Pernyataan umum di awal paragraf utama teks.",
                    "Interpretasi atau kesimpulan akhir dari sang penulis.",
                    "Kalimat penutup atau saran bagi para pembaca."
                ],
                pembahasan: "Teks eksplanasi memiliki struktur Pernyataan Umum, Deretan Penjelas, dan Interpretasi. Rincian tahapan sebuah proses selalu berada pada Deretan Penjelas."
            },
            {
                jenis: "gambar",
                imgSrc: "gambar/berita-opini.jpg",
                imgCaption: "",
                pertanyaan: "Penulis berita pada gambar menyisipkan kalimat: 'Film dokumenter ini sungguh menyentuh hati.' Alasan kalimat tersebut tergolong opini adalah karena...",
                jawabanBenar: "Memuat penilaian subjektif dari si penulis berita.",
                jawabanSalah: [
                    "Menceritakan peristiwa yang sama sekali belum terjadi.",
                    "Didukung oleh data statistik yang sangat konkret.",
                    "Berisi laporan langsung dari lokasi kejadian perkara."
                ],
                pembahasan: "Frasa 'sungguh menyentuh hati' merupakan emosi atau penilaian subjektif penulis, sehingga mutlak dikategorikan sebagai opini."
            },
            {
                jenis: "teks",
                pertanyaan: "Andi menulis email berbunyi: 'Yth. Bapak Budi, terlampir tugas bahasa Indonesia saya.' Kata 'Yth.' merupakan singkatan. Perbedaan paling mendasar antara singkatan dan akronim adalah...",
                jawabanBenar: "Singkatan dieja per huruf, akronim dibaca utuh.",
                jawabanSalah: [
                    "Singkatan selalu huruf kapital, akronim huruf kecil.",
                    "Singkatan untuk nama instansi, akronim nama orang.",
                    "Singkatan pasti menggunakan angka, akronim pasti tidak."
                ],
                pembahasan: "Singkatan biasanya dilafalkan huruf demi huruf (seperti SD, Yth.), sedangkan akronim dilafalkan seperti sebuah kata utuh (seperti Pemilu)."
            },
            {
                jenis: "teks",
                pertanyaan: "Dalam sebuah teks eksplanasi tentang terjadinya pelangi, terdapat kalimat: 'Cahaya matahari yang melewati tetesan air hujan akan dibiaskan.' Kalimat ini dikategorikan sebagai fakta karena...",
                jawabanBenar: "Merupakan proses alam yang diakui kebenaran ilmiahnya.",
                jawabanSalah: [
                    "Merupakan dugaan para ilmuwan pada masa lalu.",
                    "Mengandung kata sifat yang sangat menarik perhatian.",
                    "Merupakan imajinasi kreatif penulis teks cerita tersebut."
                ],
                pembahasan: "Kalimat tersebut adalah fakta karena menyatakan hukum fisika alam yang kebenarannya objektif dan dapat dibuktikan secara ilmiah."
            },
            {
                jenis: "teks",
                pertanyaan: "Ketika kamu berinteraksi sebagai warga dunia melalui email dengan teman di negara lain, etika paling tepat untuk menyampaikan ketidaksetujuan akan sebuah fenomena budaya adalah...",
                jawabanBenar: "Menggunakan bahasa yang sopan dan alasan logis.",
                jawabanSalah: [
                    "Menyalahkan budaya negara mereka secara sangat terbuka.",
                    "Memutuskan hubungan komunikasi tanpa adanya surat pemberitahuan.",
                    "Menggunakan huruf kapital semua dalam badan email."
                ],
                pembahasan: "Sebagai warga dunia digital yang beretika, perbedaan pandangan harus disikapi secara sopan, tidak menyinggung, dan diutarakan dengan pemikiran logis."
            },
            {
                jenis: "teks",
                pertanyaan: "Perhatikan kalimat berikut: 'Menurut perkiraan saya, besok akan turun hujan lebat di kota ini.' Kalimat ini merupakan opini dan BUKAN fakta karena...",
                jawabanBenar: "Peristiwa tersebut belum terjadi dan baru prediksi.",
                jawabanSalah: [
                    "Terdapat keterangan waktu hari esok di kalimatnya.",
                    "Cuaca selalu berubah setiap saat di perkotaan.",
                    "Hujan lebat adalah kejadian alam yang merusak."
                ],
                pembahasan: "Fakta adalah sesuatu yang sudah terjadi atau mutlak benar. Prediksi hari esok ('menurut perkiraan') masih berupa dugaan semata."
            },
            {
                jenis: "teks",
                pertanyaan: "Ciri utama kebahasaan dari teks eksplanasi yang membedakannya dari teks deskripsi biasa adalah penggunaan konjungsi kausalitas. Contoh konjungsi kausalitas tersebut adalah...",
                jawabanBenar: "Sebab, karena, oleh karena itu, dan sehingga.",
                jawabanSalah: [
                    "Dan, serta, kemudian, lalu, dan setelah itu.",
                    "Bahkan, malahan, tidak hanya, melainkan, dan tetapi.",
                    "Di sana, di sini, ke sana, kemari."
                ],
                pembahasan: "Konjungsi kausalitas berfungsi untuk menyatakan hubungan sebab-akibat yang sangat krusial dalam struktur teks eksplanasi."
            },
            {
                jenis: "teks",
                pertanyaan: "Ditinjau dari kaidah pelafalan bahasa Indonesia, manakah pernyataan di bawah ini yang paling akurat dalam membedakan antara akronim dan singkatan?",
                jawabanBenar: "Akronim diucapkan layaknya sebuah kata bahasa utuh.",
                jawabanSalah: [
                    "Singkatan diucapkan dengan mengeja seluruh huruf vokal.",
                    "Akronim selalu ditulis dengan menggunakan huruf kapital.",
                    "Singkatan hanya dipakai untuk nama sebuah lembaga."
                ],
                pembahasan: "Akronim (contoh: Sembako) dapat diucapkan langsung sebagai satu kata, tidak perlu mengeja huruf demi huruf seperti singkatan (contoh: KTP)."
            },
            {
                jenis: "teks",
                pertanyaan: "Di antara pilihan berikut ini, manakah yang merupakan contoh akronim yang dibentuk dari gabungan suku kata?",
                jawabanBenar: "Pemilu dari kata pemilihan umum.",
                jawabanSalah: [
                    "DPR dari dewan perwakilan rakyat.",
                    "KTP dari kartu tanda penduduk.",
                    "SMP dari sekolah menengah pertama."
                ],
                pembahasan: "Pemilu (Pemilihan Umum) adalah akronim. Sedangkan DPR, KTP, dan SMP adalah singkatan karena harus dieja per huruf."
            },
            {
                jenis: "teks",
                pertanyaan: "Ibu pergi ke pasar untuk membeli sembako. Mengapa kata 'sembako' diklasifikasikan ke dalam kategori akronim?",
                jawabanBenar: "Karena gabungan suku kata dibaca secara utuh.",
                jawabanSalah: [
                    "Karena gabungan abjadnya dieja satu per satu.",
                    "Karena istilah tersebut berasal dari bahasa asing.",
                    "Karena kata tersebut merupakan singkatan gelar resmi."
                ],
                pembahasan: "Sembako (Sembilan Bahan Pokok) disebut akronim karena cara pelafalannya yang langsung menyatu sebagai satu kata utuh, bukan dieja S-E-M-B-A-K-O."
            },
            {
                jenis: "teks",
                pertanyaan: "Dalam korespondensi resmi, penulisan singkatan sapaan yang sesuai dengan PUEBI (Pedoman Umum Ejaan Bahasa Indonesia) adalah...",
                jawabanBenar: "Bapak ditulis Bpk. dan Saudara ditulis Sdr.",
                jawabanSalah: [
                    "Bapak ditulis Bpk dan Saudara ditulis Sdr",
                    "Bapak ditulis Bpk., dan Saudara ditulis Saudr.",
                    "Bapak ditulis Bp., dan Saudara disingkat Sda."
                ],
                pembahasan: "Singkatan sapaan seperti Bapak, Saudara, dan Ibu harus diakhiri dengan tanda titik. Bpk. dan Sdr. adalah bentuk baku."
            },
            {
                jenis: "teks",
                pertanyaan: "Fakta dan opini adalah dua elemen yang sering muncul dalam berita. Ciri paling menonjol dari sebuah kalimat opini adalah...",
                jawabanBenar: "Mengandung pendapat pribadi dari sang penulis berita.",
                jawabanSalah: [
                    "Memiliki data yang dapat dibuktikan secara mutlak.",
                    "Berisi ramalan peristiwa cuaca pada masa lampau.",
                    "Menggunakan kata bilangan yang sangat tidak jelas."
                ],
                pembahasan: "Opini bersumber dari pikiran, pandangan, atau perasaan pribadi seseorang sehingga belum tentu disetujui oleh orang lain."
            },
            {
                jenis: "teks",
                pertanyaan: "Bacalah keempat kalimat di bawah ini dengan saksama. Kalimat manakah yang murni merupakan sebuah opini?",
                jawabanBenar: "Rasa makanan ini sungguh sangat lezat sekali.",
                jawabanSalah: [
                    "Ibu kota negara kita tercinta adalah Jakarta.",
                    "Sapi perah adalah contoh hewan pemakan rumput.",
                    "Satu jam terdiri atas enam-puluh satuan menit."
                ],
                pembahasan: "Ukuran 'lezat' sangat subjektif dan berbeda bagi tiap orang, sehingga kalimat tersebut merupakan opini."
            },
            {
                jenis: "teks",
                pertanyaan: "Sebuah teks lingkungan memuat berbagai informasi. Manakah dari kalimat berikut yang merupakan fakta yang dapat dipertanggungjawabkan?",
                jawabanBenar: "Suhu rata-rata bumi meningkat satu derajat celcius.",
                jawabanSalah: [
                    "Cuaca panas ini sungguh membuat tubuh lelah.",
                    "Seharusnya manusia lebih peduli pada lingkungan sekitar.",
                    "Mungkin es di kutub akan segera mencair."
                ],
                pembahasan: "Suhu meningkat 1 derajat celcius adalah data yang bisa diukur dengan termometer (fakta). Sisanya mengandung perasaan, saran, dan perkiraan."
            },
            {
                jenis: "teks",
                pertanyaan: "Untuk mengidentifikasi kalimat opini di dalam sebuah paragraf, kita bisa mencari kata-kata penanda khusus opini, yaitu...",
                jawabanBenar: "Sebaiknya, mungkin, dan juga menurut pendapat saya.",
                jawabanSalah: [
                    "Telah, sudah, dan juga pada tahun tersebut.",
                    "Adalah, merupakan, dan juga yaitu sebagai berikut.",
                    "Berdasarkan, terbukti, dan juga data survei menunjukkan."
                ],
                pembahasan: "Kata-kata seperti 'sebaiknya', 'mungkin', 'seharusnya', dan 'menurut saya' adalah penanda kuat bahwa kalimat tersebut berisi pendapat pribadi (opini)."
            },
            {
                jenis: "teks",
                pertanyaan: "Saat menulis surat elektronik (email), kita disediakan fitur lampiran (attachment). Fungsi utama dari fitur ini adalah untuk...",
                jawabanBenar: "Mengirimkan dokumen atau berkas tambahan ukuran besar.",
                jawabanSalah: [
                    "Menuliskan judul utama pada subjek surat elektronik.",
                    "Menyembunyikan alamat email dari penerima pesan lainnya.",
                    "Membalas pesan secara otomatis kepada si pengirim."
                ],
                pembahasan: "Fitur Attachment (ikon penjepit kertas) digunakan untuk melampirkan file seperti dokumen, foto, atau video ke dalam email."
            },
            {
                jenis: "teks",
                pertanyaan: "Kolom subjek (subject) pada surat elektronik tidak boleh diabaikan. Penulisan subjek email yang paling tepat sebaiknya bersifat...",
                jawabanBenar: "Singkat, padat, dan langsung mencerminkan isi pesan.",
                jawabanSalah: [
                    "Panjang lebar dan berisi seluruh salinan pesan.",
                    "Dibiarkan kosong agar penerima menjadi sangat penasaran.",
                    "Menggunakan huruf kapital pada seluruh ejaan kata."
                ],
                pembahasan: "Subjek email berfungsi sebagai judul surat. Harus ditulis secara ringkas dan mewakili maksud utama agar penerima langsung paham tujuan email."
            },
            {
                jenis: "teks",
                pertanyaan: "Kamu akan mengirimkan tugas bahasa Indonesia melalui surat elektronik kepada gurumu. Bahasa yang paling tepat untuk digunakan adalah...",
                jawabanBenar: "Menggunakan bahasa Indonesia baku yang sangat sopan.",
                jawabanSalah: [
                    "Menggunakan bahasa gaul remaja yang sedang populer.",
                    "Menggunakan singkatan acak agar pesan cepat dibaca.",
                    "Menggunakan huruf tebal merah pada semua kalimat."
                ],
                pembahasan: "Mengirim email kepada guru atau instansi resmi harus selalu mengedepankan etika, menggunakan sapaan resmi, dan tata bahasa baku yang sopan."
            },
            {
                jenis: "teks",
                pertanyaan: "Bagian penutup dalam surat elektronik resmi memiliki standar kesopanan. Contoh kalimat penutup email resmi yang paling tepat adalah...",
                jawabanBenar: "Atas perhatian Bapak, saya mengucapkan terima kasih.",
                jawabanSalah: [
                    "Demikian surat ini, sekian dan terima kasih.",
                    "Balas pesan saya cepat ya, Pak Guru.",
                    "Sampai jumpa lagi pada kesempatan yang lain."
                ],
                pembahasan: "'Atas perhatian Bapak, saya mengucapkan terima kasih' adalah frasa penutup baku yang paling profesional dan sopan."
            },
            {
                jenis: "teks",
                pertanyaan: "Teks eksplanasi disusun untuk menjelaskan fenomena. Pada paragraf pertama atau bagian pernyataan umum, penulis biasanya akan menyajikan...",
                jawabanBenar: "Penjelasan umum mengenai fenomena yang sedang dibahas.",
                jawabanSalah: [
                    "Rangkaian proses terjadinya suatu peristiwa alam tersebut.",
                    "Kesimpulan akhir dan pendapat dari sang penulis.",
                    "Ajakan kepada pembaca untuk melakukan suatu perbuatan."
                ],
                pembahasan: "Struktur pembuka teks eksplanasi (Pernyataan Umum) selalu berisi definisi atau penjelasan dasar/pengenalan tentang topik yang akan dibahas."
            },
            {
                jenis: "teks",
                pertanyaan: "Sebuah teks eksplanasi tentang gempa bumi memuat kalimat yang menunjukkan sebab-akibat. Konjungsi yang umum digunakan untuk pola ini adalah...",
                jawabanBenar: "Oleh karena itu, sehingga, dan juga menyebabkan.",
                jawabanSalah: [
                    "Pada zaman dahulu, suatu hari, dan kemudian.",
                    "Wahai kawan kawan, marilah kita, ayo semua.",
                    "Menurut pendapat saya pribadi, sebaiknya, dan mungkin."
                ],
                pembahasan: "Teks eksplanasi menceritakan proses sebab dan akibat (kausalitas), maka sangat bergantung pada konjungsi kausalitas."
            },
            {
                jenis: "teks",
                pertanyaan: "Sebagai salah satu karya non-fiksi yang dipelajari siswa kelas 5, teks eksplanasi secara khusus bertujuan untuk memberikan informasi tentang...",
                jawabanBenar: "Proses terjadinya suatu fenomena alam atau sosial.",
                jawabanSalah: [
                    "Cara membuat suatu makanan atau minuman tradisional.",
                    "Cerita fiksi yang menghibur para pembaca setianya.",
                    "Pengalaman pribadi penulis pada masa lalu kehidupannya."
                ],
                pembahasan: "Teks eksplanasi (explanation text) khusus menjelaskan mengapa dan bagaimana suatu peristiwa (alam, ilmu pengetahuan, sosial, budaya) dapat terjadi."
            }
        ];

        let currentUser = { nama: "", kelas: "" };
        let currentSoalIndex = 0;
        let score = 0;
        let userAnswers = []; 
        let shuffledOptions = []; 

        // Inisialisasi Riwayat di Login
        function tampilkanRiwayat() {
            const historyBox = document.getElementById('history-box');
            historyBox.innerHTML = '';
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            if (history.length === 0) {
                historyBox.innerHTML = '<i style="color: #777;">Belum ada riwayat pengerjaan kuis di perangkat ini.</i>';
                return;
            }

            // Tampilkan dari yang paling baru
            history.slice().reverse().forEach(item => {
                let div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `üïí <strong>${item.waktu}</strong> | üë§ ${item.nama} (Kelas: ${item.kelas}) | üèÜ Skor: <strong style="color: #4CAF50;">${item.skor}</strong>`;
                historyBox.appendChild(div);
            });
        }
        window.onload = tampilkanRiwayat;

        function mulaiKuis() {
            const nama = document.getElementById('nama').value.trim();
            const kelas = document.getElementById('kelas').value.trim();

            if (!nama || !kelas) {
                alert("Harap lengkapi isian Nama dan Kelas terlebih dahulu!");
                return;
            }

            currentUser.nama = nama;
            currentUser.kelas = kelas;
            currentSoalIndex = 0;
            score = 0;
            userAnswers = new Array(bankSoal.length).fill(null);

            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('quiz-screen').style.display = 'block';

            tampilkanSoal();
        }

        // Fungsi mengacak array (Fisher-Yates) - Untuk mengacak opsi per soal
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function tampilkanSoal() {
            const soal = bankSoal[currentSoalIndex];
            
            // UI Reset
            document.getElementById('q-counter').innerText = `üìù Soal: ${currentSoalIndex + 1} dari ${bankSoal.length}`;
            document.getElementById('score-live').innerText = `‚≠ê Skor Sementara: ${Math.round((score / bankSoal.length) * 100)}`;
            document.getElementById('pembahasan-box').style.display = 'none';
            document.getElementById('btn-next').style.display = 'none';
            document.getElementById('btn-finish').style.display = 'none';
            
            document.getElementById('btn-prev').style.visibility = (currentSoalIndex === 0) ? 'hidden' : 'visible';

            // Setup Gambar
            const imgEl = document.getElementById('q-img');
            const capEl = document.getElementById('q-caption');
            if (soal.jenis === "gambar") {
                imgEl.src = soal.imgSrc;
                imgEl.style.display = 'block';
                capEl.innerText = soal.imgCaption;
                capEl.style.display = 'block';
            } else {
                imgEl.style.display = 'none';
                capEl.style.display = 'none';
            }

            // Setup Teks
            document.getElementById('q-text').innerText = `${currentSoalIndex + 1}. ${soal.pertanyaan}`;

            // Setup Pilihan (Diacak untuk mencegah hafalan letak jawaban)
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';

            // Jika belum pernah dijawab, kita acak opsinya. Jika sudah, kita tampilkan urutan yg sama
            if (!shuffledOptions[currentSoalIndex]) {
                let opts = [{text: soal.jawabanBenar, isCorrect: true}];
                soal.jawabanSalah.forEach(opt => opts.push({text: opt, isCorrect: false}));
                shuffledOptions[currentSoalIndex] = shuffleArray(opts);
            }

            const currentOptions = shuffledOptions[currentSoalIndex];
            const isSudahDijawab = userAnswers[currentSoalIndex] !== null;

            currentOptions.forEach((opt) => {
                let btn = document.createElement('button');
                btn.className = 'option-btn';
                // Menambahkan label A, B, C, D (opsional, tapi mempermanis tampilan)
                btn.innerText = opt.text;
                
                if (isSudahDijawab) {
                    btn.disabled = true;
                    // Tampilkan warna untuk jawaban yang benar
                    if (opt.isCorrect) {
                        btn.classList.add('correct');
                    } else if (userAnswers[currentSoalIndex] === opt.text) {
                        // Jika ini jawaban user yg salah
                        btn.classList.add('wrong');
                    }
                } else {
                    btn.onclick = () => cekJawaban(btn, opt, soal.pembahasan);
                }
                optionsContainer.appendChild(btn);
            });

            if (isSudahDijawab) {
                tampilkanPembahasanDulu(soal.pembahasan);
                cekTombolNavigasiAkhir();
            }
        }

        function cekJawaban(clickedBtn, selectedOpt, teksPembahasan) {
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.disabled = true); // Kunci semua jawaban setelah diklik

            // Simpan jawaban user (kita simpan teksnya agar bisa dilacak mana yang salah diklik)
            userAnswers[currentSoalIndex] = selectedOpt.text;

            if (selectedOpt.isCorrect) {
                clickedBtn.classList.add('correct');
                score++;
            } else {
                clickedBtn.classList.add('wrong');
                // Highlight juga jawaban yang sebenarnya benar
                const currentOpts = shuffledOptions[currentSoalIndex];
                const correctIndex = currentOpts.findIndex(o => o.isCorrect);
                buttons[correctIndex].classList.add('correct');
            }

            // Update live score
            document.getElementById('score-live').innerText = `‚≠ê Skor Sementara: ${Math.round((score / bankSoal.length) * 100)}`;
            
            tampilkanPembahasanDulu(teksPembahasan);
            cekTombolNavigasiAkhir();
        }

        function tampilkanPembahasanDulu(teks) {
            const pemBox = document.getElementById('pembahasan-box');
            document.getElementById('pembahasan-text').innerText = teks;
            pemBox.style.display = 'block';
        }

        function cekTombolNavigasiAkhir() {
            if (currentSoalIndex < bankSoal.length - 1) {
                document.getElementById('btn-next').style.display = 'block';
            } else {
                document.getElementById('btn-finish').style.display = 'block';
            }
        }

        function soalSelanjutnya() {
            if (currentSoalIndex < bankSoal.length - 1) {
                currentSoalIndex++;
                tampilkanSoal();
            }
        }

        function soalSebelumnya() {
            if (currentSoalIndex > 0) {
                currentSoalIndex--;
                tampilkanSoal();
            }
        }

        function selesaiKuis() {
            document.getElementById('quiz-screen').style.display = 'none';
            document.getElementById('result-screen').style.display = 'block';

            const nilaiAkhir = Math.round((score / bankSoal.length) * 100);
            document.getElementById('res-nama').innerText = currentUser.nama;
            document.getElementById('res-skor').innerText = nilaiAkhir;

            // Simpan ke local storage dengan aman
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            let today = new Date();
            let timeStr = today.toLocaleDateString('id-ID') + " " + today.toLocaleTimeString('id-ID');
            
            history.push({
                nama: currentUser.nama,
                kelas: currentUser.kelas,
                waktu: timeStr,
                skor: nilaiAkhir
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
        }

        // Mencegah Inspect Element dan Shortcut DevTools
        document.onkeydown = function(e) {
            if (e.keyCode == 123) { return false; } // F12
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) { return false; } // Ctrl+Shift+I
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) { return false; } // Ctrl+Shift+C
            if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) { return false; } // Ctrl+Shift+J
            if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) { return false; } // Ctrl+U
        }
    </script>
</body>
</html>