<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis IPAS Kelas 5 - Daerah Kebangganku</title>
    <style>
        /* Desain Umum dan Keamanan CSS (Anti Select) */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #74ebd5 0%, #9face6 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            user-select: none; /* Anti block/select text */
            -webkit-user-select: none;
            -ms-user-select: none;
        }

        /* Header */
        .header {
            background-color: #ff6b6b;
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Container Utama */
        .container {
            flex: 1;
            max-width: 800px;
            margin: 30px auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            width: 90%;
        }

        /* Tampilan Layar */
        .screen { display: none; }
        .screen.active { display: block; }

        /* Form Login & Tombol */
        input[type="text"] {
            width: calc(100% - 24px);
            padding: 12px;
            margin: 10px 0;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        button {
            padding: 12px 20px;
            margin: 10px 5px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s;
        }
        .btn-primary { background-color: #4facfe; color: white; }
        .btn-primary:hover { background-color: #00f2fe; }
        .btn-home { background-color: #fca5a5; color: white; width: 100%; margin: 10px 0; }
        .btn-home:hover { background-color: #ef4444; }

        /* Pilihan Jawaban */
        .option-btn {
            display: block;
            width: 100%;
            text-align: left;
            background-color: #f1f5f9;
            color: #333;
            border: 2px solid #e2e8f0;
            margin: 10px 0;
        }
        .option-btn:hover:not(:disabled) { background-color: #e2e8f0; }
        .option-btn:disabled { cursor: not-allowed; }
        
        .correct { background-color: #22c55e !important; color: white !important; border-color: #16a34a !important; }
        .incorrect { background-color: #ef4444 !important; color: white !important; border-color: #dc2626 !important; }

        /* Navigasi Kuis */
        .quiz-nav { display: flex; justify-content: space-between; margin-top: 20px; }
        .score-display { font-size: 18px; font-weight: bold; text-align: center; margin-top: 20px; color: #4facfe; }
        .explanation { margin-top: 15px; padding: 15px; background-color: #fffbeb; border-left: 5px solid #f59e0b; border-radius: 4px; display: none; }

        /* Gambar Soal */
        .question-image { max-width: 100%; height: auto; border-radius: 8px; margin-bottom: 15px; display: none; }

        /* Riwayat Skor */
        .history-box { margin-top: 30px; background: #f8fafc; padding: 15px; border-radius: 8px; border: 1px solid #e2e8f0; }
        .history-item { padding: 8px 0; border-bottom: 1px solid #ddd; font-size: 14px; }

        /* Footer */
        .footer {
            background-color: #1a202c;
            color: #e2e8f0;
            text-align: center;
            padding: 15px;
            font-size: 14px;
            margin-top: auto;
        }
        .footer a { color: #38bdf8; text-decoration: none; font-weight: bold; }
        .footer a:hover { text-decoration: underline; }
    </style>
</head>
<body oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onpaste="return false;" ondragstart="return false;">

    <div class="header">
        Kode Soal: IPAS -K5-S2-B7-HOTS
    </div>

    <div class="container">
        <div id="login-screen" class="screen active">
            <h2 style="text-align: center; color: #4facfe;">Selamat Datang di Kuis Interaktif</h2>
            <p style="text-align: center;">Silakan masukkan data diri Anda untuk memulai.</p>
            <input type="text" id="input-nama" placeholder="Masukkan Nama Lengkap" required>
            <input type="text" id="input-kelas" placeholder="Masukkan Kelas" required>
            
            <button class="btn-primary" style="width: 100%; margin: 15px 0;" onclick="startQuiz()">Mulai Kuis</button>
            <button class="btn-home" onclick="window.location.href='../index.html'">Kembali ke Home</button>
            
            <div class="history-box">
                <h3>Riwayat Pencapaian Skor</h3>
                <div id="history-list">Belum ada riwayat pengerjaan.</div>
            </div>
        </div>

        <div id="quiz-screen" class="screen">
            <h3 id="question-number" style="color: #ff6b6b; margin-top: 0;"></h3>
            <p id="question-text" style="font-size: 18px; line-height: 1.6; font-weight: bold;"></p>
            
            <img id="question-img" class="question-image" src="" alt="Gambar Soal">
            
            <div id="options-container"></div>
            
            <div id="explanation-box" class="explanation"></div>

            <div class="quiz-nav">
                <button id="btn-prev" class="btn-primary" onclick="prevQuestion()" disabled>Soal Sebelumnya</button>
                <button id="btn-next" class="btn-primary" onclick="nextQuestion()" disabled>Soal Selanjutnya</button>
            </div>
            
            <div class="score-display" id="score-display">Skor Sementara: 0</div>
        </div>

        <div id="result-screen" class="screen">
            <h2 style="text-align: center; color: #22c55e;">Kuis Selesai!</h2>
            <h1 style="text-align: center; font-size: 48px; margin: 10px 0;" id="final-score"></h1>
            <p style="text-align: center;" id="final-message"></p>
            <button class="btn-primary" style="width: 100%; margin-top: 20px;" onclick="finishQuiz()">Kembali ke Halaman Awal</button>
        </div>
    </div>

    <div class="footer">
        Oleh: Dwi Endrasto<br>
        Produk ini asli jika didapatkan/dibeli melalui <a href="https://lynk.id/smartbanksoal" target="_blank">https://lynk.id/smartbanksoal</a>
    </div>

    <script>
        /* ================= KUMPULAN SOAL ================= */
        // Panjang kata pilihan jawaban disetarakan agar trik pilihan jawaban terpenuhi.
        const questions = [
            {
                text: "Masyarakat di desa X mulai meninggalkan kain tenun lokal dan lebih suka pakaian impor. Dampak ekonomi jangka panjang yang paling logis bagi daerah tersebut adalah...",
                img: "",
                options: [
                    "Penurunan drastis pendapatan para pengrajin kain tenun lokal",
                    "Peningkatan drastis pendapatan para pengrajin kain tenun lokal",
                    "Penurunan drastis kualitas bahan kain tenun buatan impor",
                    "Peningkatan drastis kualitas bahan kain tenun buatan impor"
                ],
                answer: 0,
                explanation: "Pembahasan: Jika masyarakat meninggalkan produk lokal, permintaan menurun yang mengakibatkan pengrajin kehilangan sumber pendapatan utama mereka."
            },
            {
                text: "Daerah pegunungan memiliki suhu dingin, sedangkan pesisir bersuhu panas. Perbedaan aktivitas ekonomi yang paling tepat akibat kondisi tersebut adalah...",
                img: "",
                options: [
                    "Pegunungan menghasilkan sayur mayor, pesisir menghasilkan garam laut",
                    "Pegunungan menghasilkan garam laut, pesisir menghasilkan sayur mayor",
                    "Pegunungan membutuhkan kapal laut, pesisir membutuhkan jaket tebal",
                    "Pegunungan membutuhkan jaket tebal, pesisir membutuhkan kapal selam"
                ],
                answer: 0,
                explanation: "Pembahasan: Suhu dingin di pegunungan cocok untuk hortikultura (sayur), sedangkan pesisir cocok untuk penguapan air laut menjadi garam."
            },
            {
                text: "Sebuah tradisi upacara adat menarik banyak turis asing. Langkah inovatif yang bisa dilakukan pemuda setempat untuk memajukan ekonomi tanpa merusak tradisi adalah...",
                img: "",
                options: [
                    "Membuat kerajinan tangan khas tradisi tersebut untuk cinderamata",
                    "Mengubah prosesi upacara adat agar lebih modern dan sangat cepat",
                    "Menutup area tradisi agar warga asing tidak masuk sembarangan",
                    "Menaikkan harga tiket masuk dengan sangat mahal bagi warga lokal"
                ],
                answer: 0,
                explanation: "Pembahasan: Menjual kerajinan tangan memanfaatkan peluang ekonomi pariwisata tanpa mengubah kesakralan tradisi itu sendiri."
            },
            {
                text: "Jika suatu daerah kaya akan hasil rotan namun masyarakatnya masih miskin, analisis masalah utama yang paling mungkin terjadi di daerah tersebut adalah...",
                img: "",
                options: [
                    "Rotan dijual dalam bentuk mentah tanpa diolah menjadi barang jadi",
                    "Rotan dijual dalam bentuk matang setelah diolah menjadi perabotan",
                    "Penduduk lebih suka menggunakan bahan plastik daripada bahan rotan",
                    "Penduduk terlalu sibuk menanam rotan dibandingkan memanen rotan"
                ],
                answer: 0,
                explanation: "Pembahasan: Menjual bahan mentah memiliki nilai jual rendah. Kemiskinan terjadi karena tidak ada nilai tambah industri pengolahan."
            },
            {
                text: "Tari daerah mulai jarang diminati anak muda. Cara paling efektif menggunakan teknologi untuk melestarikan dan menjadikan budaya ini kebanggaan adalah...",
                img: "",
                options: [
                    "Membuat konten video tarian menarik di media sosial secara rutin",
                    "Menghapus semua video tarian modern yang ada di media sosial",
                    "Memaksa anak muda menonton pertunjukan secara langsung tiap hari",
                    "Melarang tarian luar negeri masuk ke dalam platform media sosial"
                ],
                answer: 0,
                explanation: "Pembahasan: Teknologi media sosial adalah alat kampanye yang paling efektif untuk menarik minat generasi muda masa kini."
            },
            {
                text: "Pasar tradisional bersaing dengan pasar modern. Keunggulan utama pasar tradisional yang tidak bisa ditiru oleh pasar modern secara persis adalah...",
                img: "",
                options: [
                    "Adanya interaksi tawar menawar langsung antara penjual dan pembeli",
                    "Adanya pendingin ruangan yang membuat area belanja sangat nyaman",
                    "Adanya label harga pas yang tertempel rapi di setiap barang dagangan",
                    "Adanya keranjang dorong yang besar untuk menampung barang belanja"
                ],
                answer: 0,
                explanation: "Pembahasan: Tawar menawar adalah interaksi sosial dan budaya khas pasar tradisional yang membangun kedekatan antara penjual dan pembeli."
            },
            {
                text: "Daerah Y kaya akan rempah-rempah sejak zaman dahulu. Saat ini, strategi terbaik untuk menjadikan rempah-rempah sebagai daya saing global adalah...",
                img: "",
                options: [
                    "Mengolah rempah menjadi produk kosmetik atau obat herbal modern",
                    "Menebang semua pohon rempah untuk diganti dengan kelapa sawit",
                    "Menyimpan semua rempah di gudang agar harganya melambung tinggi",
                    "Mengonsumsi semua rempah tersebut secara mandiri tanpa sisa sedikit"
                ],
                answer: 0,
                explanation: "Pembahasan: Inovasi mengubah bahan mentah (rempah) menjadi produk bernilai tinggi (kosmetik/herbal) akan meningkatkan daya saing global."
            },
            {
                text: "Budaya gotong royong memindahkan rumah di Sulawesi (Mappalette Bola) menunjukkan nilai penting dalam masyarakat berupa...",
                img: "",
                options: [
                    "Tingginya rasa kebersamaan dan persatuan masyarakat setempat",
                    "Tingginya keinginan masyarakat untuk pamer kekuatan fisik murni",
                    "Rendahnya biaya untuk menyewa jasa tukang bangunan modern",
                    "Rendahnya kualitas kayu yang digunakan untuk membuat pondasi"
                ],
                answer: 0,
                explanation: "Pembahasan: Mappalette Bola tidak bisa dilakukan tanpa kerja sama kolektif, mencerminkan persatuan yang kuat di masyarakat."
            },
            {
                text: "Pemerintah daerah membuat festival kuliner tahunan. Dampak berantai (multiplier effect) yang paling dirasakan oleh sektor ekonomi lain adalah...",
                img: "",
                options: [
                    "Tingkat hunian penginapan dan penggunaan jasa transportasi naik",
                    "Tingkat kebersihan lingkungan sekitar area festival menjadi menurun",
                    "Tingkat penjualan makanan instan di pasar swalayan melonjak tajam",
                    "Tingkat kemacetan lalu lintas membuat warga lokal semakin betah"
                ],
                answer: 0,
                explanation: "Pembahasan: Festival menarik wisatawan. Wisatawan butuh tempat tidur (hotel) dan kendaraan, sehingga menguntungkan sektor lain."
            },
            {
                text: "Sebagian masyarakat pesisir beralih dari nelayan menjadi pengrajin kerang. Alasan ekonomi yang paling mendasari perubahan profesi ini adalah...",
                img: "",
                options: [
                    "Hasil penjualan kerajinan lebih menjanjikan dibanding tangkapan ikan",
                    "Masyarakat pesisir merasa bosan mencari ikan di laut yang sangat luas",
                    "Cuaca laut pesisir saat ini selalu cerah sehingga aman bagi pelayaran",
                    "Pemerintah daerah melarang penangkapan ikan menggunakan kail pancing"
                ],
                answer: 0,
                explanation: "Pembahasan: Perubahan profesi massal biasanya terjadi karena adanya motif ekonomi, yaitu potensi pendapatan yang lebih stabil atau tinggi."
            },
            {
                text: "Dalam menghadapi era globalisasi, warisan budaya lokal sering terancam. Sikap kritis yang harus dimiliki siswa kelas 5 adalah...",
                img: "",
                options: [
                    "Menyaring budaya asing dan tetap bangga memakai produk budaya lokal",
                    "Menerima seluruh budaya asing karena dinilai lebih maju dan modern",
                    "Menolak seluruh budaya asing tanpa mau tahu perkembangan dunia luar",
                    "Mengabaikan budaya lokal karena dianggap sudah usang dan tertinggal"
                ],
                answer: 0,
                explanation: "Pembahasan: Menyaring budaya (filterisasi) dan menjaga kebanggaan lokal adalah sikap paling bijak menghadapi globalisasi."
            },
            {
                text: "Keberagaman suku bangsa di suatu daerah seharusnya tidak memicu konflik, melainkan dimanfaatkan sebagai...",
                img: "",
                options: [
                    "Kekuatan pariwisata budaya yang dapat menarik wisatawan mancanegara",
                    "Kekuatan politik untuk menguasai kelompok suku yang lebih sedikit",
                    "Alasan utama untuk memisahkan wilayah berdasarkan asal usul bahasa",
                    "Alat untuk memicu persaingan tidak sehat dalam bidang perekonomian"
                ],
                answer: 0,
                explanation: "Pembahasan: Keberagaman adalah aset budaya yang sangat kaya, bisa dipromosikan sebagai daya tarik wisata (cultural tourism)."
            },
            {
                text: "Kondisi tanah vulkanis di sekitar gunung berapi sangat subur. Analisis keuntungan letak geografis ini bagi ekonomi penduduk adalah...",
                img: "",
                options: [
                    "Penduduk dapat menghasilkan panen pertanian yang sangat melimpah ruah",
                    "Penduduk dapat menambang emas dan perak di seluruh lereng pegunungan",
                    "Penduduk dapat membangun pabrik industri besar dengan biaya sangat murah",
                    "Penduduk dapat membuat pelabuhan kapal laut berskala internasional"
                ],
                answer: 0,
                explanation: "Pembahasan: Tanah vulkanis sangat kaya mineral, membuat pertanian subur yang berujung pada tingginya hasil panen."
            },
            {
                text: "Salah satu kearifan lokal dalam pertanian adalah sistem Subak di Bali. Peran Subak yang tidak hanya sebatas pengairan adalah...",
                img: "",
                options: [
                    "Menjaga kerukunan antar petani melalui prinsip keadilan bagi semua",
                    "Meningkatkan persaingan memperebutkan air di musim kemarau panjang",
                    "Mengurangi pendapatan petani karena harus membayar iuran yang mahal",
                    "Memaksa petani menanam satu jenis padi unggulan dari pemerintah saja"
                ],
                answer: 0,
                explanation: "Pembahasan: Subak juga merupakan sistem sosial kemasyarakatan yang mengajarkan gotong royong, keadilan distribusi, dan harmoni."
            },
            {
                text: "Batik diakui sebagai warisan budaya tak benda oleh UNESCO. Hal ini membuktikan bahwa budaya daerah kita...",
                img: "",
                options: [
                    "Diakui memiliki nilai seni tinggi dan bermakna penting bagi peradaban",
                    "Dianggap sebagai pakaian resmi yang wajib dipakai penduduk seluruh dunia",
                    "Hanya boleh diproduksi oleh masyarakat yang tinggal di wilayah pulau Jawa",
                    "Sudah kehilangan maknanya sehingga harus disimpan di dalam museum luar"
                ],
                answer: 0,
                explanation: "Pembahasan: Pengakuan UNESCO berarti budaya kita diakui secara global karena filosofi, teknik, dan nilai historisnya yang luar biasa."
            },
            /* SOAL BERGAMBAR (5 SOAL) - Pastikan edit "img/soal_X.jpg" dengan path gambar Anda */
            {
                text: "Perhatikan gambar alat transportasi tradisional di atas! Kelemahan alat transportasi ini jika dibandingkan transportasi modern untuk sektor ekonomi logistik adalah...",
                img: "gambar/soal_16.jpg", /* Keterangan Gambar: Gambar pedati/delman/gerobak sapi */
                options: [
                    "Daya tampung barang dan kecepatan tempuhnya jauh lebih rendah",
                    "Daya tampung barang dan kecepatan tempuhnya jauh lebih tinggi",
                    "Menghasilkan polusi udara yang jauh lebih tebal dan berbahaya",
                    "Membutuhkan bahan bakar minyak yang jauh lebih mahal harganya"
                ],
                answer: 0,
                explanation: "Pembahasan: Transportasi tradisional ditarik hewan sangat terbatas dalam kecepatan dan kapasitas muatan dibanding truk modern."
            },
            {
                text: "Gambar di atas menunjukkan aktivitas tambang pasir. Dampak negatif jangka panjang bagi kondisi lingkungan dan ekonomi masa depan daerah tersebut adalah...",
                img: "gambar/soal_17.jpg", /* Keterangan Gambar: Gambar penambangan pasir liar di sungai */
                options: [
                    "Kerusakan ekosistem sungai dan hilangnya potensi wisata alam",
                    "Perbaikan ekosistem sungai dan bertambahnya potensi wisata alam",
                    "Peningkatan kesejahteraan seluruh masyarakat desa secara merata",
                    "Penurunan tingkat polusi air akibat penyaringan pasir secara terus menerus"
                ],
                answer: 0,
                explanation: "Pembahasan: Tambang pasir merusak bentuk sungai, menghilangkan habitat biota, dan merusak keindahan untuk potensi wisata."
            },
            {
                text: "Perhatikan gambar rumah adat di atas! Bentuk atap dan panggung rumah tersebut dirancang sedemikian rupa dengan tujuan utama...",
                img: "gambar/soal_18.jpg", /* Keterangan Gambar: Gambar rumah panggung / rumah gadang */
                options: [
                    "Menghindari ancaman banjir dan serangan dari binatang buas",
                    "Menghindari masuknya cahaya matahari ke dalam ruang keluarga",
                    "Memudahkan pemilik rumah mengawasi warga desa dari ketinggian",
                    "Mempersulit tamu dari luar daerah yang ingin berkunjung masuk"
                ],
                answer: 0,
                explanation: "Pembahasan: Konsep rumah panggung pada kearifan lokal dibuat untuk melindungi penghuni dari kelembaban, genangan air/banjir, dan hewan liar."
            },
            {
                text: "Pada gambar terlihat masyarakat sedang melakukan panen garam. Faktor iklim yang paling menentukan keberhasilan produksi ekonomi ini adalah...",
                img: "gambar/soal_19.jpg", /* Keterangan Gambar: Gambar tambak garam pesisir laut */
                options: [
                    "Panjangnya musim kemarau dan tingkat intensitas cahaya matahari",
                    "Panjangnya musim penghujan dan tingkat kelembaban udara sekitar",
                    "Kencangnya tiupan angin barat yang membawa banyak uap air hujan",
                    "Dinginnya suhu udara pada malam hari di sekitar wilayah perairan laut"
                ],
                answer: 0,
                explanation: "Pembahasan: Garam dibuat dari penguapan air laut. Oleh karena itu, panas matahari yang terik (kemarau panjang) sangat krusial."
            },
            {
                text: "Berdasarkan gambar proses produksi di atas, tahapan yang memberikan nilai jual (value added) paling tinggi pada produk daerah tersebut adalah...",
                img: "gambar/soal_20.jpg", /* Keterangan Gambar: Gambar pengolahan biji kopi / cokelat dari panen hingga kemasan */
                options: [
                    "Saat proses pengemasan akhir dengan desain merek yang menarik",
                    "Saat proses memetik hasil panen buah mentah langsung dari pohon",
                    "Saat proses menjemur biji di bawah terik sinar matahari langsung",
                    "Saat proses mencuci biji menggunakan air sungai yang mengalir deras"
                ],
                answer: 0,
                explanation: "Pembahasan: Dalam rantai nilai ekonomi, proses pengemasan (branding) siap jual memberikan lompatan harga (nilai tambah) terbesar."
            },
            /* Lanjutan Soal non-gambar */
            {
                text: "Hutan adat dijaga ketat oleh hukum suku. Jika dilihat dari kacamata ekonomi jangka panjang, tindakan menjaga hutan ini berfungsi untuk...",
                img: "",
                options: [
                    "Menjamin ketersediaan sumber air bagi lahan pertanian mereka",
                    "Menyembunyikan harta karun nenek moyang dari pandangan luar",
                    "Menghindari kewajiban membayar pajak lahan kepada pemerintah",
                    "Mencegah masyarakat desa menjadi terlalu kaya dan sombong"
                ],
                answer: 0,
                explanation: "Pembahasan: Hutan adalah resapan air. Tanpa hutan, mata air kering, sehingga pertanian yang merupakan urat nadi ekonomi akan hancur."
            },
            {
                text: "Makanan khas daerah seringkali dibuat dengan bahan pengawet alami seperti pengasapan. Alasan geografis zaman dahulu munculnya teknik ini adalah...",
                img: "",
                options: [
                    "Kondisi alam yang jauh dari perkotaan dan tidak ada mesin pendingin",
                    "Kondisi alam yang selalu bersuhu minus derajat seperti kutub utara",
                    "Keinginan masyarakat untuk menjual makanan tersebut ke luar negeri",
                    "Perintah langsung dari raja zaman dahulu untuk menghemat bahan baku"
                ],
                answer: 0,
                explanation: "Pembahasan: Karena tidak ada kulkas, pengasapan atau penggaraman (kearifan lokal) adalah respons bertahan hidup agar makanan awet."
            },
            {
                text: "Di era digital, anak muda daerah Z membuat aplikasi untuk menjual kerajinan lokal ke seluruh dunia. Dampak paling signifikan bagi masyarakat daerah Z adalah...",
                img: "",
                options: [
                    "Terbukanya lapangan kerja baru dan hilangnya batasan pasar tradisional",
                    "Tertutupnya akses pasar internasional karena kalah saing dengan mesin",
                    "Terjadinya penurunan minat masyarakat untuk memproduksi kerajinan",
                    "Terjadinya pemutusan hubungan kerja bagi para kurir pengiriman barang"
                ],
                answer: 0,
                explanation: "Pembahasan: Aplikasi membuka pasar global, menembus batas geografis, sehingga pesanan naik dan butuh banyak pekerja baru."
            },
            {
                text: "Pemerintah membangun jalan tol yang membelah suatu daerah pertanian. Solusi untuk menjaga perekonomian petani agar tidak merosot adalah...",
                img: "",
                options: [
                    "Membangun area rest area khusus untuk menjual produk panen lokal",
                    "Menutup jalan tol tersebut agar tidak ada kendaraan yang bisa lewat",
                    "Memaksa petani untuk beralih profesi menjadi penjaga gerbang tol",
                    "Menghancurkan seluruh lahan pertanian untuk dijadikan aspal beton"
                ],
                answer: 0,
                explanation: "Pembahasan: Mengintegrasikan hasil lokal (pertanian/UMKM) ke fasilitas modern (rest area tol) adalah kolaborasi ekonomi yang saling menguntungkan."
            },
            {
                text: "Pertunjukan wayang perlahan digabungkan dengan teknologi proyeksi cahaya. Analisis mengenai fenomena budaya ini yang paling tepat adalah...",
                img: "",
                options: [
                    "Budaya sifatnya dinamis, beradaptasi dengan zaman agar tetap diminati",
                    "Budaya asli telah sepenuhnya hancur dan digantikan teknologi modern",
                    "Dalang wayang sudah tidak memiliki kemampuan seni yang mumpuni",
                    "Generasi muda sudah tidak lagi menghargai peninggalan nenek moyang"
                ],
                answer: 0,
                explanation: "Pembahasan: Modifikasi budaya dengan teknologi bukanlah perusakan, melainkan bentuk adaptasi (dinamis) agar budaya tersebut bertahan (survive)."
            }
        ];

        /* ================= SISTEM & LOGIKA KUIS ================= */
        const STORAGE_KEY = 'history_IPAS_K5_S2_B7';
        let currentUser = { nama: '', kelas: '' };
        let currentQuestionIndex = 0;
        let score = 0;
        let userAnswers = new Array(questions.length).fill(null);
        let shuffledOptions = [];

        // Inisialisasi awal saat load
        window.onload = function() {
            loadHistory();
        }

        // Mulai Kuis
        function startQuiz() {
            const nama = document.getElementById('input-nama').value.trim();
            const kelas = document.getElementById('input-kelas').value.trim();

            if (!nama || !kelas) {
                alert("Harap isi Nama dan Kelas terlebih dahulu!");
                return;
            }

            currentUser = { nama, kelas };
            currentQuestionIndex = 0;
            score = 0;
            userAnswers = new Array(questions.length).fill(null);
            
            document.getElementById('login-screen').classList.remove('active');
            document.getElementById('quiz-screen').classList.add('active');
            
            loadQuestion();
        }

        // Fungsi mengacak array (Fisher-Yates Shuffle)
        function shuffleArray(array) {
            let arr = array.map((val, index) => ({ val, index }));
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        // Memuat Soal
        function loadQuestion() {
            const q = questions[currentQuestionIndex];
            
            document.getElementById('question-number').innerText = `Soal ${currentQuestionIndex + 1} dari ${questions.length}`;
            document.getElementById('question-text').innerText = q.text;

            // Handle Gambar
            const imgElement = document.getElementById('question-img');
            if (q.img && q.img !== "") {
                imgElement.src = q.img;
                imgElement.style.display = "block";
            } else {
                imgElement.style.display = "none";
            }

            // Area Pilihan Jawaban
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            // Sembunyikan Pembahasan
            const explBox = document.getElementById('explanation-box');
            explBox.style.display = "none";
            explBox.innerText = q.explanation;

            // Trik Posisi Jawaban Diacak
            shuffledOptions = shuffleArray(q.options);
            const answered = userAnswers[currentQuestionIndex];

            shuffledOptions.forEach((optionObj) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = optionObj.val;
                btn.onclick = () => selectAnswer(optionObj.index, btn);
                
                // Jika sudah pernah dijawab sebelumnya (navigasi balik)
                if (answered !== null) {
                    btn.disabled = true;
                    if (optionObj.index === q.answer) {
                        btn.classList.add('correct');
                    } else if (optionObj.index === answered) {
                        btn.classList.add('incorrect');
                    }
                }
                
                optionsContainer.appendChild(btn);
            });

            // Tampilkan pembahasan jika sudah dijawab
            if (answered !== null) {
                explBox.style.display = "block";
            }

            // Update Navigasi
            document.getElementById('btn-prev').disabled = currentQuestionIndex === 0;
            // Ubah tombol Next jika di soal terakhir
            const btnNext = document.getElementById('btn-next');
            if (currentQuestionIndex === questions.length - 1) {
                btnNext.innerText = "Selesai & Lihat Nilai";
                btnNext.disabled = answered === null; 
            } else {
                btnNext.innerText = "Soal Selanjutnya";
                btnNext.disabled = answered === null;
            }

            updateScoreDisplay();
        }

        // Memilih Jawaban
        function selectAnswer(selectedIndex, btnElement) {
            const q = questions[currentQuestionIndex];
            userAnswers[currentQuestionIndex] = selectedIndex;
            
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.disabled = true);

            if (selectedIndex === q.answer) {
                btnElement.classList.add('correct');
                score += (100 / questions.length); // Kalkulasi skor dinamis
            } else {
                btnElement.classList.add('incorrect');
                // Cari jawaban benar dan hijaukan
                buttons.forEach((b, i) => {
                    if (shuffledOptions[i].index === q.answer) {
                        b.classList.add('correct');
                    }
                });
            }

            document.getElementById('explanation-box').style.display = "block";
            document.getElementById('btn-next').disabled = false;
            updateScoreDisplay();
        }

        // Navigasi
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResult();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion();
            }
        }

        function updateScoreDisplay() {
            document.getElementById('score-display').innerText = `Skor Sementara: ${Math.round(score)}`;
        }

        // Hasil Akhir
        function showResult() {
            document.getElementById('quiz-screen').classList.remove('active');
            document.getElementById('result-screen').classList.add('active');
            
            const finalScore = Math.round(score);
            document.getElementById('final-score').innerText = finalScore;
            
            let msg = "";
            if(finalScore >= 80) msg = "Luar biasa! Pemahaman HOTS Anda sangat baik.";
            else if(finalScore >= 60) msg = "Bagus! Anda sudah memahami konsep dasar.";
            else msg = "Jangan menyerah, mari pelajari materinya lagi.";
            
            document.getElementById('final-message').innerText = msg;

            saveHistory(finalScore);
        }

        // Penyimpanan Riwayat
        function saveHistory(finalScore) {
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            const date = new Date();
            const timeString = `${date.getDate()}/${date.getMonth()+1}/${date.getFullYear()} ${date.getHours()}:${date.getMinutes()}`;
            
            history.unshift({
                nama: currentUser.nama,
                kelas: currentUser.kelas,
                waktu: timeString,
                skor: finalScore
            });

            // Simpan max 10 riwayat agar rapi
            if(history.length > 10) history.pop(); 
            
            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
        }

        function loadHistory() {
            const historyList = document.getElementById('history-list');
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            if (history.length === 0) {
                historyList.innerHTML = "Belum ada riwayat pengerjaan.";
                return;
            }

            historyList.innerHTML = "";
            history.forEach(item => {
                const div = document.createElement('div');
                div.className = 'history-item';
                div.innerHTML = `<strong>${item.nama}</strong> (Kelas ${item.kelas}) - Skor: <strong>${item.skor}</strong> <br><span style="color:#888; font-size:12px;">‚è∞ ${item.waktu}</span>`;
                historyList.appendChild(div);
            });
        }

        function finishQuiz() {
            document.getElementById('result-screen').classList.remove('active');
            document.getElementById('login-screen').classList.add('active');
            
            // Reset form
            document.getElementById('input-nama').value = '';
            document.getElementById('input-kelas').value = '';
            
            loadHistory();
        }
    </script>
</body>
</html>