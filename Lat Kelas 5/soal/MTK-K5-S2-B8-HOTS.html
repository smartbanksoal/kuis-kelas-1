<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Matematika: MTK-K5-S2-B8-HOTS</title>
    <style>
        /* CSS Variables & Global Styles */
        :root {
            --primary: #4e54c8;
            --secondary: #8f94fb;
            --bg-color: #f4f7f6;
            --text-color: #333;
            --correct: #28a745;
            --wrong: #dc3545;
            --footer-bg: #1a1a1a;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-color) 0%, #e0eafc 100%);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            /* Proteksi Copy Paste (Visual) */
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Header */
        header {
            background: linear-gradient(90deg, #ff9966, #ff5e62);
            color: white;
            text-align: center;
            padding: 15px;
            font-size: 1.2rem;
            font-weight: bold;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        /* Main Container */
        main {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            padding: 30px;
            width: 100%;
            max-width: 800px;
            position: relative;
        }

        /* Screens */
        #login-screen, #quiz-screen, #result-screen {
            display: none;
        }
        #login-screen.active, #quiz-screen.active, #result-screen.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Formulir Login */
        .form-group {
            margin-bottom: 15px;
        }
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .form-group input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            box-sizing: border-box;
        }
        .btn {
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            width: 100%;
            margin-top: 10px;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(78, 84, 200, 0.4);
        }
        
        .btn-home {
            background: linear-gradient(90deg, #11998e, #38ef7d);
            margin-bottom: 20px;
        }

        /* History & Scoreboard */
        .history-container {
            margin-top: 30px;
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        .history-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .history-table th, .history-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .history-table th {
            background-color: var(--primary);
            color: white;
        }

        /* Kuis Elements */
        .info-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: bold;
            color: var(--primary);
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
        }
        .question-text {
            font-size: 1.2rem;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        .question-image {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 2px dashed #ccc;
            padding: 5px;
        }
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        @media (max-width: 600px) {
            .options { grid-template-columns: 1fr; }
        }
        .option-btn {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            text-align: left;
            transition: all 0.2s;
        }
        .option-btn:hover:not(:disabled) {
            background: #e9ecef;
            border-color: #adb5bd;
        }
        .option-btn:disabled {
            cursor: not-allowed;
            color: #333;
        }
        .option-btn.correct {
            background-color: var(--correct);
            border-color: var(--correct);
            color: white;
        }
        .option-btn.wrong {
            background-color: var(--wrong);
            border-color: var(--wrong);
            color: white;
        }

        /* Pembahasan & Navigasi Kuis */
        #explanation-box {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background: #e0f7fa;
            border-left: 5px solid #00bcd4;
            border-radius: 5px;
        }
        .quiz-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .quiz-nav button {
            width: 48%;
            display: none; /* Hidden until answered */
        }
        
        #btn-prev {
            background: #6c757d;
        }

        /* Footer */
        footer {
            background: var(--footer-bg);
            color: #ccc;
            text-align: center;
            padding: 20px;
            font-size: 0.9rem;
        }
        footer a {
            color: #ff9966;
            text-decoration: none;
            font-weight: bold;
        }
        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body oncontextmenu="return false;" oncopy="return false;" oncut="return false;" onpaste="return false;">

    <header id="main-header">
        KODE SOAL: MTK-K5-S2-B8-HOTS
    </header>

    <main>
        <div id="login-screen" class="container active">
            <h2 style="text-align: center; color: var(--primary);">Selamat Datang di Kuis Interaktif</h2>
            <p style="text-align: center;">Materi: Pengumpulan Data & Diagram Batang (HOTS)</p>
            
            <button class="btn btn-home" onclick="window.location.href='../index.html'">üè† Kembali ke Home</button>

            <div class="form-group">
                <label for="student-name">Nama Lengkap</label>
                <input type="text" id="student-name" placeholder="Masukkan nama lengkap Anda..." required>
            </div>
            <div class="form-group">
                <label for="student-class">Kelas</label>
                <input type="text" id="student-class" placeholder="Contoh: 5A" required>
            </div>
            <button class="btn" onclick="startQuiz()">Mulai Kuis</button>

            <div class="history-container">
                <h3>Riwayat Skor</h3>
                <table class="history-table">
                    <thead>
                        <tr>
                            <th>Waktu</th>
                            <th>Nama</th>
                            <th>Kelas</th>
                            <th>Skor</th>
                        </tr>
                    </thead>
                    <tbody id="history-body">
                        </tbody>
                </table>
            </div>
        </div>

        <div id="quiz-screen" class="container">
            <div class="info-bar">
                <span id="question-counter">Soal 1 / 25</span>
                <span id="current-score">Skor Sementara: 0</span>
            </div>
            
            <div id="question-container">
                <img id="q-image" class="question-image" src="" alt="Gambar Soal" style="display: none;">
                <div id="q-text" class="question-text">Teks soal akan muncul di sini...</div>
                
                <div class="options" id="options-container">
                    </div>
            </div>

            <div id="explanation-box">
                <strong>Pembahasan:</strong> <span id="explanation-text"></span>
            </div>

            <div class="quiz-nav">
                <button id="btn-prev" class="btn" onclick="prevQuestion()">‚¨ÖÔ∏è Sebelumnya</button>
                <button id="btn-next" class="btn" onclick="nextQuestion()">Selanjutnya ‚û°Ô∏è</button>
                <button id="btn-finish" class="btn" onclick="finishQuiz()" style="display:none; background: #28a745;">Selesai & Lihat Nilai</button>
            </div>
        </div>

        <div id="result-screen" class="container" style="text-align: center;">
            <h2 style="color: var(--primary);">Kuis Selesai!</h2>
            <p>Terima kasih telah mengerjakan kuis ini, <span id="result-name" style="font-weight:bold;"></span>.</p>
            <h1 style="font-size: 4rem; margin: 20px 0; color: #ff5e62;" id="final-score">100</h1>
            <p id="result-message"></p>
            <button class="btn" onclick="location.reload()">Kembali ke Halaman Awal</button>
        </div>
    </main>

    <footer>
        <div id="footer-content">
            &copy; <span id="current-year"></span> Oleh: Dwi Endrasto.<br>
            Produk ini asli jika didapatkan/dibeli melalui <a href="https://lynk.id/smartbanksoal" target="_blank">https://lynk.id/smartbanksoal</a>
        </div>
    </footer>

    <script>
        // Set Tahun Otomatis
        document.getElementById('current-year').textContent = new Date().getFullYear();

        // Keamanan Tambahan
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && (e.key === 'c' || e.key === 'u' || e.key === 'i' || e.key === 'j' || e.key === 's')) {
                e.preventDefault();
            }
        });

        // Konfigurasi Kuis
        const STORAGE_KEY = 'history_MTK_K5_S2_B8_HOTS';
        let currentUser = { name: '', class: '' };
        let currentQuestionIndex = 0;
        let score = 0;
        let quizQuestions = [];
        let userAnswers = []; // Array of booleans tracking correct/wrong

        // DATA SOAL (25 Soal HOTS)
        const allQuestionsData = [
            // 5 SOAL BERGAMBAR
            {
                type: 'image',
                imgSrc: 'gambar/gambar_piktogram_panen.jpg', // GANTI DENGAN JALUR GAMBAR ASLI
                imgAlt: 'Keterangan Gambar: Piktogram hasil panen desa Sukamaju. 1 ikon karung besar = 100 kg, 1 ikon karung kecil = 50 kg.',
                text: 'Perhatikan piktogram hasil panen gabah Desa Sukamaju di atas! Jika total target panen tahun ini adalah 1.500 kg, dan data di gambar menunjukkan 12 karung besar serta 3 karung kecil, berapa kg lagi gabah yang harus dikumpulkan untuk mencapai target?',
                options: ['100 kg gabah', '150 kg gabah', '200 kg gabah', '250 kg gabah'],
                answer: '150 kg gabah',
                explanation: 'Total di gambar = (12 x 100) + (3 x 50) = 1.200 + 150 = 1.350 kg. Kekurangan = 1.500 - 1.350 = 150 kg.'
            },
            {
                type: 'image',
                imgSrc: 'gambar/gambar_diagram_batang_ganda.jpg', // GANTI DENGAN JALUR GAMBAR ASLI
                imgAlt: 'Keterangan Gambar: Diagram batang ganda membandingkan nilai Ulangan Harian 1 dan 2 dari 4 siswa (Andi, Budi, Caca, Dedi).',
                text: 'Diagram batang ganda di atas menunjukkan nilai Matematika empat siswa. Siapakah siswa yang mengalami penurunan nilai paling tajam dari Ulangan 1 ke Ulangan 2, dan apa faktor pemicu yang mungkin terlihat dari selisih batangnya?',
                options: ['Andi, turun 15 poin', 'Budi, turun 20 poin', 'Caca, turun 10 poin', 'Dedi, turun 25 poin'],
                answer: 'Budi, turun 20 poin',
                explanation: 'Dengan membandingkan tinggi batang biru (Ulangan 1) dan merah (Ulangan 2), Budi memiliki selisih penurunan terbesar yaitu 20 poin.'
            },
            {
                type: 'image',
                imgSrc: 'gambar/gambar_diagram_horizontal.jpg', // GANTI DENGAN JALUR GAMBAR ASLI
                imgAlt: 'Keterangan Gambar: Diagram batang horizontal penjualan alat tulis. Pensil (80), Pulpen (65), Penghapus (40), Penggaris (?).',
                text: 'Diagram batang horizontal di atas mencatat penjualan toko. Jika total semua alat tulis yang terjual adalah 250 buah, berapakah jumlah penggaris yang terjual, dan alat tulis apa yang menempati posisi penjualan terendah kedua?',
                options: ['65, Penghapus ada', '55, Penghapus ada', '65, Penggaris ada', '55, Penggaris ada'],
                answer: '65, Penggaris ada',
                explanation: 'Total diketahui = 80 + 65 + 40 = 185. Penggaris = 250 - 185 = 65 buah. Urutan dari bawah: Penghapus (40), Penggaris (65), dsb.'
            },
            {
                type: 'image',
                imgSrc: 'gambar/gambar_tabel_frekuensi.jpg', // GANTI DENGAN JALUR GAMBAR ASLI
                imgAlt: 'Keterangan Gambar: Tabel frekuensi data tinggi badan siswa kelas 5. Terdapat noda tinta yang menutupi jumlah siswa dengan tinggi 135 cm.',
                text: 'Terdapat noda tinta pada tabel frekuensi di atas! Jika diketahui jumlah seluruh siswa kelas 5 adalah 40 anak, berapakah banyak siswa yang memiliki tinggi 135 cm berdasarkan sisa data yang terbaca (130cm=8, 140cm=12, 145cm=5)?',
                options: ['Lima belas anak', 'Empat belas anak', 'Tiga belas anak', 'Dua belas anak'],
                answer: 'Lima belas anak',
                explanation: 'Siswa terbaca = 8 + 12 + 5 = 25 anak. Siswa tinggi 135 cm = Total (40) - 25 = 15 anak.'
            },
            {
                type: 'image',
                imgSrc: 'gambar/gambar_analisis_piktogram.jpg', // GANTI DENGAN JALUR GAMBAR ASLI
                imgAlt: 'Keterangan Gambar: Piktogram sumbangan buku cerita. Hari Senin-Kamis. Hari Rabu kosong (belum digambar ikonnya).',
                text: 'Panitia amal lupa menggambar ikon piktogram untuk hari Rabu. Jika rata-rata sumbangan buku cerita per hari dari Senin hingga Kamis adalah 30 buku, dan total Senin, Selasa, Kamis adalah 80 buku, berapa banyak ikon penuh (1 ikon = 10 buku) yang harus digambar untuk hari Rabu?',
                options: ['Ada tiga ikon', 'Ada empat ikon', 'Ada lima ikon', 'Ada enam ikon'],
                answer: 'Ada empat ikon',
                explanation: 'Total sumbangan 4 hari = 30 x 4 = 120 buku. Hari Rabu = 120 - 80 = 40 buku. Karena 1 ikon mewakili 10 buku, dibutuhkan 4 ikon.'
            },
            // 20 SOAL TEKS (HOTS)
            {
                type: 'text', text: 'Siti ingin membuat diagram batang tentang makanan kesukaan teman sekelasnya. Dia mencatat: 12 suka bakso, 8 suka mie ayam, dan sisanya suka nasi goreng. Jika jumlah siswa 32 orang, bagaimana perbandingan tinggi batang bakso dan nasi goreng jika digambar pada kertas kotak-kotak?',
                options: ['Sama tinggi persis', 'Bakso lebih tinggi', 'Nasi goreng tinggi', 'Selisih satu kotak'],
                answer: 'Sama tinggi persis',
                explanation: 'Siswa suka nasi goreng = 32 - (12 + 8) = 12 orang. Karena bakso juga 12 orang, tinggi batangnya pasti sama.'
            },
            {
                type: 'text', text: 'Data hasil panen buah (dalam kuintal) disajikan dalam diagram batang vertikal. Mangga 15, Apel 20, Jeruk 35, Melon x. Jika rentang (selisih panen terbanyak dan paling sedikit) adalah 25 kuintal, dan Apel bukanlah yang paling sedikit, berapakah hasil panen Melon?',
                options: ['Sepuluh kuintal', 'Lima belas kuintal', 'Dua puluh kuintal', 'Dua lima kuintal'],
                answer: 'Sepuluh kuintal',
                explanation: 'Panen terbanyak sementara Jeruk (35). Agar rentang = 25, nilai terendah harus 35 - 25 = 10. Maka Melon = 10 kuintal.'
            },
            {
                type: 'text', text: 'Sebuah piktogram menggunakan ikon apel utuh untuk 20 kg dan setengah apel untuk 10 kg. Jika penjualan hari ini adalah 170 kg, kombinasi ikon manakah yang paling tepat dan efisien untuk digunakan?',
                options: ['8 utuh, 1 setengah', '7 utuh, 3 setengah', '9 utuh, 0 setengah', '6 utuh, 5 setengah'],
                answer: '8 utuh, 1 setengah',
                explanation: '(8 x 20) + (1 x 10) = 160 + 10 = 170 kg. Ini adalah cara paling efisien sesuai aturan piktogram.'
            },
            {
                type: 'text', text: 'Dalam pengumpulan data berat badan 20 siswa, rata-rata sementara adalah 40 kg. Tiba-tiba masuk data Andi yang beratnya 61 kg. Analisislah perubahan apa yang akan terjadi pada diagram batang frekuensinya nanti!',
                options: ['Batang 61kg muncul', 'Batang 40kg hilang', 'Semua batang naik', 'Grafik akan turun'],
                answer: 'Batang 61kg muncul',
                explanation: 'Diagram frekuensi menghitung jumlah siswa pada nilai tertentu. Data baru (61 kg) akan membuat satu kategori batang baru atau menambah frekuensi di batang 61 kg.'
            },
            {
                type: 'text', text: 'Pak Guru menugaskan siswa membuat diagram batang ganda hobi siswa putra dan putri. Jika hobi "Berenang" digemari 10 putra dan 10 putri, bagaimana penampakan dua batang tersebut pada grafik?',
                options: ['Saling berdampingan', 'Putra lebih tinggi', 'Putri lebih tinggi', 'Hanya satu batang'],
                answer: 'Saling berdampingan',
                explanation: 'Pada diagram batang ganda, data putra dan putri untuk kategori yang sama (Berenang) akan diletakkan berdampingan dengan tinggi yang sama.'
            },
            {
                type: 'text', text: 'Data penjualan tiket: Kelas VIP turun stabil tiap hari, sedangkan Ekonomi naik drastis. Jika dibuat diagram batang ganda selama seminggu, pola apa yang terbentuk dari ujung atas batang-batangnya?',
                options: ['VIP turun, Eko naik', 'Keduanya ikut naik', 'Keduanya menurun', 'Pola akan bergelombang'],
                answer: 'VIP turun, Eko naik',
                explanation: 'Menginterpretasikan tren data: batang VIP akan membentuk tangga turun, sedangkan batang Ekonomi membentuk tangga naik.'
            },
            {
                type: 'text', text: 'Beni mendata warna favorit 40 teman: 1/4 suka Merah, 10 suka Biru, dan sisanya Hijau. Jika direpresentasikan dalam diagram batang dengan skala 1 garis = 2 anak, di garis ke berapakah ujung batang warna Hijau berada?',
                options: ['Pada garis ke sepuluh', 'Pada garis kesebelas', 'Pada garis kedelapan', 'Pada garis kesembilan'],
                answer: 'Pada garis ke sepuluh',
                explanation: 'Merah = 1/4 x 40 = 10. Biru = 10. Hijau = 40 - (10+10) = 20 anak. Karena 1 garis = 2 anak, tinggi batang hijau = 20 / 2 = 10 garis.'
            },
            {
                type: 'text', text: 'Suatu tabel frekuensi memiliki kelompok data nilai: 60, 70, 80, 90. Jika semua siswa yang bernilai 60 mengikuti remedial dan nilainya menjadi 80, batang manakah pada diagram yang akan mengalami perubahan tinggi?',
                options: ['Enam puluh, Delapan puluh', 'Tujuh puluh, Sembilan puluh', 'Hanya Delapan puluh', 'Semua batang berubah'],
                answer: 'Enam puluh, Delapan puluh',
                explanation: 'Siswa pindah dari kelompok nilai 60 ke 80. Otomatis, batang nilai 60 akan memendek (atau hilang jika semua ikut remedial) dan batang 80 akan meninggi.'
            },
            {
                type: 'text', text: 'Dua buah diagram batang menampilkan data yang sama tetapi terlihat berbeda ketajamannya. Diagram A menggunakan interval skala 5, sedangkan B intervalnya 20. Evaluasilah, diagram mana yang lebih baik untuk melihat perbedaan kecil?',
                options: ['Diagram A lebih baik', 'Diagram B lebih baik', 'Keduanya sama saja', 'Tergantung warnanya'],
                answer: 'Diagram A lebih baik',
                explanation: 'Skala yang lebih kecil (interval 5) akan lebih sensitif menampilkan selisih data yang tipis dibandingkan skala besar.'
            },
            {
                type: 'text', text: 'Pada sebuah proyek statistika, siswa dilarang melakukan survei langsung. Manakah metode pengumpulan data sekunder yang paling tepat untuk membuat diagram batang populasi harimau Sumatera selama 5 tahun terakhir?',
                options: ['Mencari di buku dinas', 'Menebak acak angka', 'Bertanya teman sekelas', 'Pergi ke hutan liar'],
                answer: 'Mencari di buku dinas',
                explanation: 'Data sekunder adalah data yang sudah dikumpulkan oleh pihak lain, contohnya lembaga resmi atau dinas kehutanan.'
            },
            {
                type: 'text', text: 'Diagram batang horizontal penjualan laptop menampilkan: Merk X = 45 unit, Merk Y = 60 unit. Jika panjang batang Merk X digambar sepanjang 9 cm, berapa centimeter panjang batang untuk Merk Y yang harus digambar agar proporsional?',
                options: ['Panjang dua belas cm', 'Panjang sepuluh cm', 'Panjang lima belas cm', 'Panjang sebelas cm'],
                answer: 'Panjang dua belas cm',
                explanation: 'Skala: 45 unit = 9 cm, maka 1 cm = 5 unit. Untuk 60 unit = 60 / 5 = 12 cm.'
            },
            {
                type: 'text', text: 'Dalam membuat piktogram pengunjung perpustakaan, Budi bingung menentukan ikon. Jumlah pengunjung per hari adalah: 145, 160, 155, 170. Agar tidak ada pecahan ikon yang rumit, apa solusi terbaik menurutmu?',
                options: ['Satu ikon untuk 5 orang', 'Satu ikon untuk 2 orang', 'Satu ikon untuk 10 orang', 'Satu ikon untuk 20 orang'],
                answer: 'Satu ikon untuk 5 orang',
                explanation: 'Semua angka berakhiran 0 atau 5, sehingga membagi dengan 5 akan menghasilkan angka bulat sempurna tanpa perlu memotong ikon menjadi bagian aneh.'
            },
            {
                type: 'text', text: 'Data tinggi tanaman: Hari 1=2cm, Hari 2=4cm, Hari 3=7cm, Hari 4=11cm. Jika tren pertumbuhan ini terus berlanjut dengan pola penambahan (+2, +3, +4...), berapakah tinggi batang untuk Hari ke-5 pada diagram nanti?',
                options: ['Tinggi enam belas cm', 'Tinggi lima belas cm', 'Tinggi tujuh belas cm', 'Tinggi lapan belas cm'],
                answer: 'Tinggi enam belas cm',
                explanation: 'Pola selisih: 2, 3, 4. Selisih berikutnya adalah 5. Tinggi Hari 5 = 11 + 5 = 16 cm.'
            },
            {
                type: 'text', text: 'Sebuah diagram batang memiliki sumbu tegak (frekuensi) dan mendatar (jenis buku). Jika posisi kedua sumbu ini ditukar, apa nama spesifik diagram yang baru terbentuk tersebut?',
                options: ['Diagram batang mendatar', 'Diagram batang vertikal', 'Diagram garis melengkung', 'Diagram lingkaran penuh'],
                answer: 'Diagram batang mendatar',
                explanation: 'Menukar sumbu tegak (frekuensi) ke sumbu mendatar akan mengubah diagram batang vertikal menjadi diagram batang horizontal (mendatar).'
            },
            {
                type: 'text', text: 'Lani melihat tabel data cacat produksi permen bulan ini: Rasa Coklat 1%, Stroberi 2%, Jeruk 0.5%. Mengapa menggunakan piktogram dengan ikon 1 permen = 100 biji SANGAT TIDAK disarankan untuk data ini?',
                options: ['Datanya terlalu kecil', 'Datanya terlalu besar', 'Warna permen berbeda', 'Kertasnya tidak muat'],
                answer: 'Datanya terlalu kecil',
                explanation: 'Data persentase atau desimal kecil (0.5%) akan sangat sulit digambar menggunakan piktogram berskala raksasa (100 biji), ikon akan terpotong sangat kecil.'
            },
            {
                type: 'text', text: 'Pada diagram batang ganda impor-ekspor negara A, batang ekspor selalu lebih tinggi daripada batang impor selama 3 tahun berturut-turut. Kesimpulan paling logis dari analisis data tersebut adalah?',
                options: ['Negara A mendapat untung', 'Negara A mengalami rugi', 'Negara A kehabisan barang', 'Negara A tidak bertani'],
                answer: 'Negara A mendapat untung',
                explanation: 'Ekspor (menjual ke luar) lebih besar daripada impor (membeli dari luar) secara umum menandakan neraca perdagangan surplus/untung.'
            },
            {
                type: 'text', text: 'Data nilai matematika disajikan dalam tabel: Nilai 70-79 (5 anak), 80-89 (12 anak), 90-100 (8 anak). Jika KKM adalah 80, analisislah persentase siswa yang lolos KKM berdasarkan data tersebut!',
                options: ['Ada delapan puluh persen', 'Ada lima puluh persen', 'Ada tujuh puluh persen', 'Ada enam puluh persen'],
                answer: 'Ada delapan puluh persen',
                explanation: 'Total siswa = 5 + 12 + 8 = 25 anak. Lolos KKM (>= 80) = 12 + 8 = 20 anak. Persentase = (20 / 25) x 100% = 80%.'
            },
            {
                type: 'text', text: 'Diagram batang vertikal patah di bagian tengahnya! Yang tersisa hanya info: Tinggi batang Benda P adalah separuh dari Benda Q. Jika Benda Q diwakili batang setinggi 14 blok, berapa blok tinggi Benda P?',
                options: ['Setinggi tujuh buah blok', 'Setinggi enam buah blok', 'Setinggi lapan buah blok', 'Setinggi sembilan blok'],
                answer: 'Setinggi tujuh buah blok',
                explanation: 'Separuh dari 14 blok adalah 14 / 2 = 7 blok.'
            },
            {
                type: 'text', text: 'Siti menyurvei kendaraan yang lewat: Motor 40, Mobil 25, Truk 15. Ia ingin menggambar diagram batang dengan skala di mana batang terpendek berukuran 3 cm. Berapa cm panjang batang terpanjang?',
                options: ['Sepanjang delapan cm', 'Sepanjang sepuluh cm', 'Sepanjang tujuh cm', 'Sepanjang enam cm'],
                answer: 'Sepanjang delapan cm',
                explanation: 'Terpendek (Truk 15) = 3 cm. Skalanya 1 cm = 5 kendaraan. Terpanjang (Motor 40) = 40 / 5 = 8 cm.'
            },
            {
                type: 'text', text: 'Dalam membuat tabel frekuensi dari data tunggal acak (contoh: 5,7,8,5,9,7...), langkah analitis pertama yang paling krusial agar tidak ada data yang terlewat atau terhitung ganda adalah dengan cara?',
                options: ['Melakukan sistem turus', 'Langsung menggambar', 'Mewarnai angka ganjil', 'Menjumlahkan semuanya'],
                answer: 'Melakukan sistem turus',
                explanation: 'Sistem turus (tally) adalah metode mencoret garis (IIII) saat mengumpulkan dan membaca data mentah agar perhitungan frekuensi akurat dan teratur.'
            }
        ];

        // FUNGSI UTAMA
        function loadHistory() {
            const historyBody = document.getElementById('history-body');
            historyBody.innerHTML = '';
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            history.forEach(entry => {
                let tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${entry.time}</td>
                    <td>${entry.name}</td>
                    <td>${entry.class}</td>
                    <td><strong>${entry.score}</strong></td>
                `;
                historyBody.appendChild(tr);
            });
        }

        function shuffleArray(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        function startQuiz() {
            const name = document.getElementById('student-name').value.trim();
            const cls = document.getElementById('student-class').value.trim();

            if(!name || !cls) {
                alert('Silakan isi Nama dan Kelas terlebih dahulu!');
                return;
            }

            currentUser = { name: name, class: cls };
            
            // Siapkan Soal
            quizQuestions = JSON.parse(JSON.stringify(allQuestionsData)); // Deep copy
            shuffleArray(quizQuestions);
            
            // Pengacakan opsi untuk setiap soal
            quizQuestions.forEach(q => {
                const originalAnswer = q.answer;
                shuffleArray(q.options);
                q.answer = originalAnswer; // keep reference to correct answer string
            });

            currentQuestionIndex = 0;
            score = 0;
            userAnswers = new Array(quizQuestions.length).fill(null);

            document.getElementById('login-screen').classList.remove('active');
            document.getElementById('quiz-screen').classList.add('active');
            
            showQuestion();
        }

        function showQuestion() {
            const q = quizQuestions[currentQuestionIndex];
            
            document.getElementById('question-counter').innerText = `Soal ${currentQuestionIndex + 1} / ${quizQuestions.length}`;
            document.getElementById('current-score').innerText = `Skor Sementara: ${score * 4}`; // 25 soal x 4 = 100

            // Penanganan Gambar
            const imgEl = document.getElementById('q-image');
            if (q.type === 'image') {
                imgEl.src = q.imgSrc;
                imgEl.alt = q.imgAlt;
                imgEl.style.display = 'block';
            } else {
                imgEl.style.display = 'none';
            }

            document.getElementById('q-text').innerText = q.text;
            
            // Bersihkan Opsi & Penjelasan
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            document.getElementById('explanation-box').style.display = 'none';

            // Navigasi
            document.getElementById('btn-prev').style.display = currentQuestionIndex > 0 ? 'block' : 'none';
            document.getElementById('btn-next').style.display = 'none';
            document.getElementById('btn-finish').style.display = 'none';

            // Generate Opsi
            q.options.forEach((opt, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.innerText = `${String.fromCharCode(65 + index)}. ${opt}`;
                
                // Jika sudah pernah dijawab sebelumnya
                if (userAnswers[currentQuestionIndex] !== null) {
                    btn.disabled = true;
                    if (opt === q.answer) {
                        btn.classList.add('correct');
                    } else if (userAnswers[currentQuestionIndex] === opt) {
                        btn.classList.add('wrong');
                    }
                } else {
                    btn.onclick = () => selectOption(btn, opt, q.answer, q.explanation);
                }
                optionsContainer.appendChild(btn);
            });

            // Tampilkan penjelasan dan tombol next jika sudah dijawab
            if (userAnswers[currentQuestionIndex] !== null) {
                showExplanation(q.explanation);
                showNextControls();
            }
        }

        function selectOption(selectedBtn, selectedText, correctText, explanation) {
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach(btn => btn.disabled = true); // Kunci semua tombol

            userAnswers[currentQuestionIndex] = selectedText;

            if (selectedText === correctText) {
                selectedBtn.classList.add('correct');
                score++;
                document.getElementById('current-score').innerText = `Skor Sementara: ${score * 4}`;
            } else {
                selectedBtn.classList.add('wrong');
                // Highlight yang benar
                buttons.forEach(btn => {
                    if (btn.innerText.substring(3) === correctText) { // substring untuk memotong "A. "
                        btn.classList.add('correct');
                    }
                });
            }

            showExplanation(explanation);
            showNextControls();
        }

        function showExplanation(text) {
            document.getElementById('explanation-text').innerText = text;
            document.getElementById('explanation-box').style.display = 'block';
        }

        function showNextControls() {
            if (currentQuestionIndex < quizQuestions.length - 1) {
                document.getElementById('btn-next').style.display = 'block';
            } else {
                document.getElementById('btn-finish').style.display = 'block';
            }
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showQuestion();
        }

        function prevQuestion() {
            currentQuestionIndex--;
            showQuestion();
        }

        function finishQuiz() {
            const finalScore = score * 4;
            document.getElementById('quiz-screen').classList.remove('active');
            document.getElementById('result-screen').classList.add('active');
            
            document.getElementById('result-name').innerText = currentUser.name;
            document.getElementById('final-score').innerText = finalScore;
            
            let message = "";
            if(finalScore >= 80) message = "Luar biasa! Pertahankan prestasimu.";
            else if(finalScore >= 60) message = "Bagus! Kamu bisa belajar lebih giat lagi.";
            else message = "Jangan menyerah, ayo pelajari lagi materinya!";
            
            document.getElementById('result-message').innerText = message;

            // Simpan ke History terisolasi
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            let now = new Date();
            let timeStr = `${now.getDate()}/${now.getMonth()+1} ${now.getHours()}:${now.getMinutes()}`;
            
            history.unshift({
                time: timeStr,
                name: currentUser.name,
                class: currentUser.class,
                score: finalScore
            });
            
            // Batasi 10 riwayat terakhir agar tidak penuh
            if(history.length > 10) history.pop();
            
            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
        }

        // Jalankan saat pertama kali buka
        window.onload = loadHistory;

    </script>
</body>
</html>