<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis PJOK Kelas 1</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;700&display=swap');

        :root {
            --primary: #FF9F1C;
            --secondary: #2EC4B6;
            --background: #FDFFFC;
            --text: #011627;
            --correct: #28a745;
            --wrong: #dc3545;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: radial-gradient(circle, #FFF2D1 0%, #FFD166 100%);
            color: var(--text);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            flex: 1;
            max-width: 700px;
            margin: 30px auto;
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 5px solid white;
            outline: 5px dashed var(--primary);
        }

        .header-code {
            text-align: center;
            font-family: 'Fredoka One', cursive;
            color: #E71D36;
            font-size: 1.2rem;
            background: #FFD166;
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            letter-spacing: 1px;
        }

        h1, h2, h3 {
            font-family: 'Fredoka One', cursive;
            text-align: center;
            color: var(--primary);
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .input-group input {
            width: 95%;
            padding: 12px;
            border: 2px solid var(--secondary);
            border-radius: 10px;
            font-size: 1rem;
            font-family: 'Nunito', sans-serif;
        }

        .btn {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 12px 25px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, background 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            background: #25a396;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-home {
            background: #34495e;
        }

        .btn-home:hover {
            background: #2c3e50;
        }

        /* Styling Pilihan Jawaban */
        .options-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            margin-top: 20px;
        }

        .option-btn {
            background: #f1f2f6;
            border: 3px solid #dfe4ea;
            padding: 15px;
            font-size: 1rem;
            font-family: 'Nunito', sans-serif;
            font-weight: bold;
            border-radius: 12px;
            cursor: pointer;
            text-align: left;
            transition: 0.3s;
        }

        .option-btn:hover:not(:disabled) {
            background: #eccc68;
            border-color: var(--primary);
        }

        .correct {
            background-color: var(--correct) !important;
            color: white !important;
            border-color: #1e7e34 !important;
        }

        .wrong {
            background-color: var(--wrong) !important;
            color: white !important;
            border-color: #bd2130 !important;
        }

        /* Pembahasan dan Navigasi */
        .explanation {
            display: none;
            background: #e0f7fa;
            border-left: 5px solid var(--secondary);
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
            font-weight: bold;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }

        .score-info {
            text-align: center;
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #E71D36;
        }

        /* History Table */
        .history-container {
            margin-top: 30px;
            border-top: 2px dashed #ccc;
            padding-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }

        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: center;
        }

        th {
            background-color: var(--primary);
            color: white;
        }

        tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        /* Footer */
        footer {
            background: #111827;
            color: #f3f4f6;
            text-align: center;
            padding: 15px 20px;
            font-size: 0.95rem;
            margin-top: auto;
            border-top: 3px solid var(--primary);
        }

        footer a {
            color: #FFD166;
            text-decoration: none;
            font-weight: bold;
        }

        footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="header-code">Kode: PJOK-K1-S2-B6-HOTS</div>

        <div id="login-screen">
            <h1>Halo Juara! üèÜ</h1>
            <p style="text-align: center;">Masukkan data dirimu untuk memulai kuis.</p>
            
            <div class="input-group">
                <label for="userName">Nama Lengkap:</label>
                <input type="text" id="userName" placeholder="Contoh: Budi Santoso" required>
            </div>
            <div class="input-group">
                <label for="userClass">Kelas:</label>
                <input type="text" id="userClass" placeholder="Contoh: 1A" required>
            </div>
            
            <button class="btn" style="width: 100%; margin-top: 10px;" onclick="startQuiz()">Mulai Mengerjakan</button>
            
            <button class="btn btn-home" style="width: 100%; margin-top: 10px;" onclick="window.location.href='../index.html'">üè† Kembali ke Home</button>

            <div class="history-container">
                <h3>üìú Riwayat Pencapaian</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Waktu</th>
                            <th>Nama</th>
                            <th>Kelas</th>
                            <th>Skor</th>
                        </tr>
                    </thead>
                    <tbody id="history-body">
                        </tbody>
                </table>
            </div>
        </div>

        <div id="quiz-screen" style="display: none;">
            <div class="score-info">Skor Sementara: <span id="current-score">0</span></div>
            <h2 id="question-number">Soal 1 / 25</h2>
            <p id="question-text" style="font-size: 1.2rem; font-weight: bold;"></p>
            
            <div class="options-container" id="options-container">
                </div>

            <div id="explanation" class="explanation"></div>

            <div class="nav-buttons">
                <button class="btn" id="btn-prev" onclick="prevQuestion()" style="background: #95a5a6;">‚¨ÖÔ∏è Sebelumnya</button>
                <button class="btn" id="btn-next" onclick="nextQuestion()">Selanjutnya ‚û°Ô∏è</button>
            </div>
        </div>

        <div id="result-screen" style="display: none; text-align: center;">
            <h1>Kerja Bagus! üéâ</h1>
            <h2>Skor Akhirmu: <span id="final-score" style="color: #E71D36; font-size: 2.5rem;">0</span> / 100</h2>
            <p>Terus semangat belajar untuk menjadi anak yang sehat dan cerdas!</p>
            <button class="btn" onclick="backToHome()">Kembali ke Halaman Awal</button>
        </div>
    </div>

    <footer>
        @ <span id="year"></span> Oleh: Dwi Endrasto, Produk ini asli jika didapatkan/dibeli melalui <a href="https://lynk.id/smartbanksoal" target="_blank">https://lynk.id/smartbanksoal</a>
    </footer>

    <script>
        // Set tahun footer otomatis
        document.getElementById("year").innerText = new Date().getFullYear();

        // Data Soal (25 Soal HOTS)
        const rawQuestions = [
            {
                q: "Budi merasa badannya lemas di pagi hari. Apa yang harus Budi lakukan agar tubuhnya kembali aktif dan sehat?",
                options: [
                    { text: "Lari pagi keliling taman", isCorrect: true },
                    { text: "Tidur lagi sampai siang", isCorrect: false },
                    { text: "Main game sambil duduk", isCorrect: false }
                ],
                explanation: "Lari pagi keliling taman adalah kegiatan fisik yang membuat aliran darah lancar dan tubuh segar kembali."
            },
            {
                q: "Kamu melihat ada lantai yang basah dan licin di sekolah. Sikap yang paling aman saat melewatinya adalah...",
                options: [
                    { text: "Jalan pelan dan hati-hati", isCorrect: true },
                    { text: "Lari cepat tanpa melihat", isCorrect: false },
                    { text: "Lompat tinggi lewati lantai", isCorrect: false }
                ],
                explanation: "Berjalan pelan dan hati-hati menjaga keseimbangan agar kita tidak terpeleset di lantai yang licin."
            },
            {
                q: "Temanmu terjatuh dari ayunan dan lututnya berdarah. Siapa yang harus segera kamu panggil untuk meminta bantuan?",
                options: [
                    { text: "Panggil guru piket segera", isCorrect: true },
                    { text: "Diam saja pura-pura lupa", isCorrect: false },
                    { text: "Ikut menangis sangat keras", isCorrect: false }
                ],
                explanation: "Guru piket adalah orang dewasa di sekolah yang bisa segera memberikan Pertolongan Pertama (P3K)."
            },
            {
                q: "Ibu menghidangkan makan siang. Agar perut tidak sakit karena kuman penyakit, apa yang harus kamu lakukan sebelumnya?",
                options: [
                    { text: "Cuci tangan pakai sabun", isCorrect: true },
                    { text: "Lap baju kotor saja", isCorrect: false },
                    { text: "Biarkan tangan tetap kotor", isCorrect: false }
                ],
                explanation: "Mencuci tangan dengan sabun membunuh kuman dari luar sehingga makanan yang masuk tetap higienis."
            },
            {
                q: "Kamu harus menyeberang jalan raya yang cukup ramai. Cara menyeberang jalan yang paling aman adalah...",
                options: [
                    { text: "Tengok kanan kiri dulu", isCorrect: true },
                    { text: "Lari cepat tutup mata", isCorrect: false },
                    { text: "Jalan santai tengah jalan", isCorrect: false }
                ],
                explanation: "Menengok ke kanan dan kiri memastikan tidak ada kendaraan yang melaju sebelum kita menyeberang."
            },
            {
                q: "Siti dibelikan sepeda baru oleh ayahnya. Agar kepala Siti aman saat bermain sepeda, Siti harus...",
                options: [
                    { text: "Pakai helm pelindung kepala", isCorrect: true },
                    { text: "Lepas tangan saat gowes", isCorrect: false },
                    { text: "Main di jalan raya", isCorrect: false }
                ],
                explanation: "Helm khusus sepeda berfungsi melindungi kepala dari benturan keras jika sewaktu-waktu terjatuh."
            },
            {
                q: "Saat bermain di lapangan, ada anjing tidak dikenal yang menyalak galak. Apa tindakan paling aman untukmu?",
                options: [
                    { text: "Lapor pada orang dewasa", isCorrect: true },
                    { text: "Lempar batu pakai tangan", isCorrect: false },
                    { text: "Lari dekati anjing itu", isCorrect: false }
                ],
                explanation: "Melapor kepada orang dewasa lebih aman daripada menghadapi atau memprovokasi hewan berbahaya sendirian."
            },
            {
                q: "Tangan Andi digigit serangga kecil dan terasa sangat gatal. Andi ingin menggaruknya. Apa akibatnya jika terus digaruk?",
                options: [
                    { text: "Kulit bisa jadi luka", isCorrect: true },
                    { text: "Badan jadi makin sehat", isCorrect: false },
                    { text: "Serangga lari ketakutan pergi", isCorrect: false }
                ],
                explanation: "Menggaruk gigitan serangga terlalu keras akan merusak kulit dan menyebabkan infeksi kuman."
            },
            {
                q: "Di depan sekolah banyak penjual makanan berwarna mencolok dan dikerubungi lalat. Jika kamu memakannya, kamu akan...",
                options: [
                    { text: "Sakit perut sangat parah", isCorrect: true },
                    { text: "Jadi juara kelas terus", isCorrect: false },
                    { text: "Tubuh jadi makin kuat", isCorrect: false }
                ],
                explanation: "Makanan yang dihinggapi lalat mengandung banyak bakteri penyebab diare dan sakit perut."
            },
            {
                q: "Dino suka menonton televisi dengan jarak yang sangat dekat di tempat gelap. Bahaya apa yang mengancam Dino?",
                options: [
                    { text: "Mata bisa jadi rusak", isCorrect: true },
                    { text: "Telinga bisa jadi tuli", isCorrect: false },
                    { text: "Hidung bisa jadi mampet", isCorrect: false }
                ],
                explanation: "Cahaya layar TV dari jarak dekat dapat merusak kesehatan mata dan menyebabkan mata minus."
            },
            {
                q: "Saat menunggu jemputan, ada orang tidak dikenal menawarkan permen dan mengajakmu pergi. Apa yang kamu lakukan?",
                options: [
                    { text: "Tolak tegas jangan ikut", isCorrect: true },
                    { text: "Minta permen manis dia", isCorrect: false },
                    { text: "Peluk erat orang itu", isCorrect: false }
                ],
                explanation: "Kita tidak boleh menerima barang atau ajakan dari orang asing demi keselamatan diri (menghindari penculikan)."
            },
            {
                q: "Menyalakan petasan dan kembang api besar sendirian tanpa diawasi oleh ayah atau ibu merupakan tindakan yang...",
                options: [
                    { text: "Sangat bahaya bagi anak", isCorrect: true },
                    { text: "Bikin tubuh jadi sehat", isCorrect: false },
                    { text: "Boleh asal sambil lari", isCorrect: false }
                ],
                explanation: "Api dan bahan peledak pada petasan bisa menyebabkan luka bakar serius jika dimainkan sembarangan."
            },
            {
                q: "Langit sedang mendung gelap dan petir menyambar-nyambar. Temanmu mengajak main bola di lapangan. Sikapmu adalah...",
                options: [
                    { text: "Tolak ajakan teman itu", isCorrect: true },
                    { text: "Ikut main sampai sore", isCorrect: false },
                    { text: "Buang bola ke sungai", isCorrect: false }
                ],
                explanation: "Berada di lapangan terbuka saat petir menyambar sangat berisiko tinggi terkena sambaran petir."
            },
            {
                q: "Saat berlari, Edo tersandung batu hingga lututnya berdarah. Langkah pertama yang harus dilakukan Edo adalah...",
                options: [
                    { text: "Cuci luka beri obat", isCorrect: true },
                    { text: "Tutup pakai daun kotor", isCorrect: false },
                    { text: "Biarkan luka tetap basah", isCorrect: false }
                ],
                explanation: "Mencuci luka membersihkannya dari kuman, kemudian diberi obat merah agar cepat sembuh."
            },
            {
                q: "Kamu terpisah dari ibumu saat jalan-jalan di pasar malam. Kamu melihat bapak polisi berjaga. Kamu harus...",
                options: [
                    { text: "Minta tolong pak polisi", isCorrect: true },
                    { text: "Lari cepat karena takut", isCorrect: false },
                    { text: "Sembunyi di dalam tenda", isCorrect: false }
                ],
                explanation: "Polisi adalah aparat keamanan yang bertugas membantu dan melindungi warga, termasuk anak yang tersesat."
            },
            {
                q: "Ibu sedang memasak di dapur. Rina diam-diam ingin bermain pisau pemotong daging. Potensi bahaya apa yang terjadi?",
                options: [
                    { text: "Tangan bisa terluka parah", isCorrect: true },
                    { text: "Jari jadi makin kuat", isCorrect: false },
                    { text: "Pisau jadi makin tajam", isCorrect: false }
                ],
                explanation: "Pisau adalah benda tajam yang bukan mainan anak-anak karena bisa menyayat kulit dan membuat pendarahan."
            },
            {
                q: "Kamu melihat adikmu yang belum bisa berenang bermain di pinggir kolam yang dalam. Apa yang harus dilakukan?",
                options: [
                    { text: "Peringatkan agar jauh menjauh", isCorrect: true },
                    { text: "Dorong adik ke air", isCorrect: false },
                    { text: "Tinggalkan main sendiri sana", isCorrect: false }
                ],
                explanation: "Bermain di dekat kolam dalam bagi yang tidak bisa berenang berisiko tenggelam, kita harus mencegahnya."
            },
            {
                q: "Bermain ponsel sambil menunduk selama berjam-jam setiap hari tanpa henti bisa membuat kondisi fisik kita...",
                options: [
                    { text: "Leher sakit dan pegal", isCorrect: true },
                    { text: "Mata jadi makin tajam", isCorrect: false },
                    { text: "Kaki jadi sangat kuat", isCorrect: false }
                ],
                explanation: "Postur menunduk terus-menerus memberikan beban berat pada tulang leher kita (text neck syndrome)."
            },
            {
                q: "Ada kabel tiang listrik yang putus dan menjuntai ke genangan air di dekat rumahmu. Kamu sebaiknya...",
                options: [
                    { text: "Jauhi genangan panggil ayah", isCorrect: true },
                    { text: "Tarik kabel pakai tangan", isCorrect: false },
                    { text: "Injak kabel pakai sepatu", isCorrect: false }
                ],
                explanation: "Air adalah penghantar listrik. Mendekati kabel putus di air bisa membuat kita tersengat arus listrik (kesetrum)."
            },
            {
                q: "Saat naik tangga penyeberangan yang cukup tinggi, sikap yang benar agar kita aman tidak terjatuh adalah...",
                options: [
                    { text: "Pegangan kuat pada besi", isCorrect: true },
                    { text: "Lari cepat ke atas", isCorrect: false },
                    { text: "Lompat dari anak tangga", isCorrect: false }
                ],
                explanation: "Memegang pagar (railing) tangga membantu menjaga keseimbangan tubuh saat naik atau turun."
            },
            {
                q: "Kamu mencium bau gas yang sangat menyengat dari arah dapur. Tindakan keselamatan yang tepat adalah...",
                options: [
                    { text: "Beri tahu ibu segera", isCorrect: true },
                    { text: "Nyalakan api kompor gas", isCorrect: false },
                    { text: "Tidur saja di kamar", isCorrect: false }
                ],
                explanation: "Bau gas menandakan kebocoran, orang dewasa perlu segera membuka jendela dan mencabut selang gas untuk mencegah ledakan."
            },
            {
                q: "Setelah olahraga berkeringat banyak, Dika memilih minum air putih hangat. Manfaat bagi tubuh Dika adalah...",
                options: [
                    { text: "Ganti cairan tubuh hilang", isCorrect: true }, 
                    { text: "Bikin gigi jadi sakit", isCorrect: false },
                    { text: "Perut jadi kembung keras", isCorrect: false }
                ],
                explanation: "Air putih hangat cepat diserap tubuh untuk mencegah dehidrasi (kekurangan cairan) setelah berolahraga."
            },
            {
                q: "Adik makan kue sambil berlari dan tertawa, lalu ia tersedak. Agar adik selamat, kita harus menyuruhnya...",
                options: [
                    { text: "Minum air putih pelan", isCorrect: true },
                    { text: "Lari putari meja makan", isCorrect: false },
                    { text: "Makan kue lagi banyak", isCorrect: false }
                ],
                explanation: "Minum air putih membantu mendorong makanan yang menyumbat di tenggorokan saat tersedak."
            },
            {
                q: "Seorang kakek di jalan tampak sesak napas dan meminta bantuan padamu untuk memanggil orang. Kamu harus...",
                options: [
                    { text: "Teriak minta tolong warga", isCorrect: true },
                    { text: "Lari hindari kakek itu", isCorrect: false },
                    { text: "Ketawa melihat kakek itu", isCorrect: false }
                ],
                explanation: "Meminta bantuan orang dewasa atau warga sekitar adalah cara terbaik saat melihat keadaan darurat medis."
            },
            {
                q: "Setelah bermain tanah dan pasir seharian di luar, tubuh penuh kuman. Cara paling tepat menjaga kesehatan adalah...",
                options: [
                    { text: "Mandi bersih pakai sabun", isCorrect: true },
                    { text: "Tidak usah gosok gigi", isCorrect: false },
                    { text: "Pakai baju kotor terus", isCorrect: false }
                ],
                explanation: "Mandi dengan sabun menghilangkan kotoran, keringat, dan bakteri yang menempel pada tubuh."
            }
        ];

        // Kunci Unik LocalStorage untuk mencegah skor nyasar
        const STORAGE_KEY = "quizHistory_PJOK_K1_S2_B6_HOTS";

        // Variabel Status Kuis
        let sessionQuestions = [];
        let currentIdx = 0;
        let score = 0;
        let userName = "";
        let userClass = "";
        const pointPerQuestion = 100 / 25; 

        // Fungsi mengacak array (Fisher-Yates)
        function shuffle(array) {
            let currentIndex = array.length, randomIndex;
            while (currentIndex != 0) {
                randomIndex = Math.floor(Math.random() * currentIndex);
                currentIndex--;
                [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
            }
            return array;
        }

        // Setup awal kuis dan pengacakan opsi sekali per sesi
        function startQuiz() {
            userName = document.getElementById("userName").value.trim();
            userClass = document.getElementById("userClass").value.trim();

            if (!userName || !userClass) {
                alert("Silakan isi Nama dan Kelas terlebih dahulu!");
                return;
            }

            // Copy dan acak opsi per soal agar stabil saat bolak-balik
            sessionQuestions = rawQuestions.map(q => {
                return {
                    question: q.q,
                    options: shuffle([...q.options]),
                    explanation: q.explanation,
                    userAnswered: false,
                    selectedOptionIdx: -1
                };
            });

            currentIdx = 0;
            score = 0;
            updateScoreUI();

            document.getElementById("login-screen").style.display = "none";
            document.getElementById("quiz-screen").style.display = "block";
            
            showQuestion();
        }

        // Render soal
        function showQuestion() {
            const qData = sessionQuestions[currentIdx];
            document.getElementById("question-number").innerText = `Soal ${currentIdx + 1} / 25`;
            document.getElementById("question-text").innerText = qData.question;
            
            const optionsContainer = document.getElementById("options-container");
            optionsContainer.innerHTML = "";
            document.getElementById("explanation").style.display = "none";

            // Tombol Navigasi
            document.getElementById("btn-prev").disabled = currentIdx === 0;
            if (currentIdx === 24) {
                document.getElementById("btn-next").innerText = "Selesai üèÅ";
                document.getElementById("btn-next").style.background = "#E71D36";
            } else {
                document.getElementById("btn-next").innerText = "Selanjutnya ‚û°Ô∏è";
                document.getElementById("btn-next").style.background = "var(--secondary)";
            }

            // Render Pilihan
            qData.options.forEach((opt, index) => {
                const btn = document.createElement("button");
                btn.className = "option-btn";
                btn.innerText = opt.text;
                
                // Jika sudah pernah dijawab
                if (qData.userAnswered) {
                    btn.disabled = true;
                    if (index === qData.selectedOptionIdx) {
                        if (opt.isCorrect) btn.classList.add("correct");
                        else btn.classList.add("wrong");
                    } else if (opt.isCorrect) {
                        btn.style.border = "3px solid var(--correct)"; // Beri petunjuk jawaban benar
                    }
                } else {
                    btn.onclick = () => selectAnswer(index, btn);
                }
                
                optionsContainer.appendChild(btn);
            });

            // Tampilkan pembahasan jika sudah dijawab
            if (qData.userAnswered) {
                showExplanation();
            }
        }

        // Fungsi pilih jawaban
        function selectAnswer(optIdx, btnElement) {
            const qData = sessionQuestions[currentIdx];
            qData.userAnswered = true;
            qData.selectedOptionIdx = optIdx;

            const isCorrect = qData.options[optIdx].isCorrect;
            
            if (isCorrect) {
                btnElement.classList.add("correct");
                score += pointPerQuestion;
                updateScoreUI();
            } else {
                btnElement.classList.add("wrong");
            }

            // Disable semua tombol
            const allBtns = document.getElementById("options-container").children;
            for (let i = 0; i < allBtns.length; i++) {
                allBtns[i].disabled = true;
                if(qData.options[i].isCorrect && i !== optIdx) {
                   allBtns[i].style.border = "3px solid var(--correct)";
                }
            }

            showExplanation();
        }

        function showExplanation() {
            const expDiv = document.getElementById("explanation");
            expDiv.innerHTML = "üí° <b>Pembahasan:</b><br>" + sessionQuestions[currentIdx].explanation;
            expDiv.style.display = "block";
        }

        function updateScoreUI() {
            document.getElementById("current-score").innerText = Math.round(score);
        }

        function prevQuestion() {
            if (currentIdx > 0) {
                currentIdx--;
                showQuestion();
            }
        }

        function nextQuestion() {
            // Wajib jawab dulu baru bisa lanjut
            if (!sessionQuestions[currentIdx].userAnswered) {
                alert("Silakan pilih jawabanmu terlebih dahulu!");
                return;
            }

            if (currentIdx < 24) {
                currentIdx++;
                showQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            document.getElementById("quiz-screen").style.display = "none";
            document.getElementById("result-screen").style.display = "block";
            
            let finalScore = Math.round(score);
            document.getElementById("final-score").innerText = finalScore;

            saveHistory(finalScore);
        }

        // MANAJEMEN HISTORY DI LOCALSTORAGE DENGAN KUNCI UNIK
        function saveHistory(finalScore) {
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            
            // Format waktu saat ini
            let now = new Date();
            let timeString = `${now.getDate()}/${now.getMonth()+1}/${now.getFullYear()} ${now.getHours()}:${now.getMinutes().toString().padStart(2,'0')}`;

            history.push({
                time: timeString,
                name: userName,
                class: userClass,
                score: finalScore
            });

            localStorage.setItem(STORAGE_KEY, JSON.stringify(history));
        }

        function loadHistory() {
            let history = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
            let tbody = document.getElementById("history-body");
            tbody.innerHTML = "";

            if (history.length === 0) {
                tbody.innerHTML = "<tr><td colspan='4'>Belum ada data pencapaian. Jadilah yang pertama!</td></tr>";
                return;
            }

            // Tampilkan history terbaru di atas
            history.reverse().forEach(record => {
                let tr = document.createElement("tr");
                tr.innerHTML = `
                    <td>${record.time}</td>
                    <td>${record.name}</td>
                    <td>${record.class}</td>
                    <td><strong>${record.score}</strong></td>
                `;
                tbody.appendChild(tr);
            });
        }

        function backToHome() {
            document.getElementById("result-screen").style.display = "none";
            document.getElementById("login-screen").style.display = "block";
            document.getElementById("userName").value = "";
            document.getElementById("userClass").value = "";
            loadHistory();
        }

        // Load History saat pertama kali halaman dimuat
        window.onload = loadHistory;

    </script>
</body>
</html>